#pragma once
#include <Python.h>


#if !(defined(_WIN32) || defined(__CYGWIN__))
    #include <arpa/inet.h>
    #include <sys/socket.h>
#else
    #include <WS2tcpip.h>
    #include <winsock2.h>
    #pragma comment(lib, "Ws2_32.lib")
#endif


typedef struct {
    PY_UINT32_T first;
    PY_UINT32_T last;
    PY_UINT32_T len;
} NetRangeObject;

NetRangeObject* NetRangeObject_create(void);

void NetRangeObject_destroy(NetRangeObject* const self);

int NetRangeObject_parseCidr(const char* cidr, NetRangeObject* netObj);

int NetRangeObject_comparator(const NetRangeObject **elem1, const NetRangeObject **elem2);

int NetRangeObject_asUtf8CharCidr(const NetRangeObject* const self, char* const str, const Py_ssize_t size);

NetRangeObject* NetRangeObject_copy(const NetRangeObject* const self);









#define IPV4_MAX_STRING_LEN 19

static const PY_UINT32_T MASK_MAP[] = {
0b00000000000000000000000000000000,
0b10000000000000000000000000000000,
0b11000000000000000000000000000000,
0b11100000000000000000000000000000,
0b11110000000000000000000000000000,
0b11111000000000000000000000000000,
0b11111100000000000000000000000000,
0b11111110000000000000000000000000,
0b11111111000000000000000000000000,
0b11111111100000000000000000000000,
0b11111111110000000000000000000000,
0b11111111111000000000000000000000,
0b11111111111100000000000000000000,
0b11111111111110000000000000000000,
0b11111111111111000000000000000000,
0b11111111111111100000000000000000,
0b11111111111111110000000000000000,
0b11111111111111111000000000000000,
0b11111111111111111100000000000000,
0b11111111111111111110000000000000,
0b11111111111111111111000000000000,
0b11111111111111111111100000000000,
0b11111111111111111111110000000000,
0b11111111111111111111111000000000,
0b11111111111111111111111100000000,
0b11111111111111111111111110000000,
0b11111111111111111111111111000000,
0b11111111111111111111111111100000,
0b11111111111111111111111111110000,
0b11111111111111111111111111111000,
0b11111111111111111111111111111100,
0b11111111111111111111111111111110,
0b11111111111111111111111111111111,
};
