"use strict";(self.webpackChunknblink=self.webpackChunknblink||[]).push([[345],{345:(t,e,o)=>{o.r(e),o.d(e,{default:()=>y});var n=o(974),s=o(586),l=o(31),i=o(607),a=o(355),c=o(256),r=o(212);let p=null;function u(t){const e=new URL(t),o=e.pathname.split("/"),n=o.indexOf("lab"),s=o.indexOf("notebooks");return-1!==n?e.origin+o.slice(0,n).join("/"):-1!==s?e.origin+o.slice(0,s).join("/"):e.origin}class d extends c.Widget{constructor(t,e){super(),this.onSettingsChange=t;const o=this.loadSettingsFromStorage();this.settings=o||{...e},this.container=document.createElement("div"),this.node.appendChild(this.container),this.buildDialog()}buildDialog(){this.container.innerHTML="",this.container.style.padding="20px",this.container.style.maxWidth="400px",this.container.style.width="100%",this.container.style.boxSizing="border-box",this.container.style.fontFamily="Arial, sans-serif";const t=this.createSwitchControl("Copy notebook output",this.settings.copyOutput,(t=>this.updateSettings({copyOutput:t})));this.container.appendChild(t);const e=document.createElement("label");e.style.display="block",e.style.marginTop="20px",e.style.marginBottom="8px",e.style.fontWeight="bold",e.textContent="URL path:",this.container.appendChild(e);const o=document.createElement("select");o.style.width="100%",o.style.padding="8px",o.style.marginBottom="15px",o.style.borderRadius="4px",o.style.border="1px solid #ccc",[{label:"JupyterLite",value:"/lab/index.html",openAsNotebook:!1},{label:"JupyterLite Notebook",value:"/lab/index.html",openAsNotebook:!0},{label:"Custom",value:"custom",openAsNotebook:!1}].forEach((t=>{const e=document.createElement("option");e.value=JSON.stringify(t),e.textContent=t.label,(t.value===this.settings.urlPath&&t.openAsNotebook===this.settings.openAsNotebook||"custom"===t.value&&null!==this.settings.customUrl)&&(e.selected=!0),o.appendChild(e)})),this.container.appendChild(o);const n=document.createElement("p");n.style.fontSize="0.9em",n.style.color="#666",n.style.marginTop="10px",n.style.marginBottom="15px",n.style.wordBreak="break-all",this.container.appendChild(n);const s=document.createElement("input");s.type="text",s.placeholder="Enter custom URL",s.style.width="100%",s.style.display=null!==this.settings.customUrl?"block":"none",s.value=this.settings.customUrl||"",this.container.appendChild(s);const l=document.createElement("p");l.style.fontSize="0.9em",l.style.color="#666",l.style.marginTop="8px",l.style.marginBottom="15px",l.style.wordBreak="break-all",l.style.display=null!==this.settings.customUrl?"block":"none",l.textContent="Custom urls should link to the /lab/index.html path for your jupyterlab/lite instance.",this.container.appendChild(l),o.addEventListener("change",(()=>{const t=JSON.parse(o.value);"custom"===t.value?(s.style.display="block",l.style.display="block",this.settings.customUrl?s.value=this.settings.customUrl:s.value="",this.updateSettings({urlPath:"custom",openAsNotebook:!1,customUrl:s.value||null})):(s.style.display="none",l.style.display="none",this.updateSettings({urlPath:t.value,openAsNotebook:t.openAsNotebook,customUrl:null})),this.updateUrlDisplay(n)})),s.addEventListener("input",(()=>{this.updateSettings({urlPath:"custom",openAsNotebook:!1,customUrl:s.value||null}),this.updateUrlDisplay(n)})),this.updateUrlDisplay(n)}updateUrlDisplay(t){if("custom"===this.settings.urlPath&&this.settings.customUrl)t.textContent=`Links to: ${this.settings.customUrl}`;else{const e=u(window.location.href),o=this.settings.urlPath.replace("/notebooks/","/lab/");t.textContent=`Links to: ${e}${o}`}}createSwitchControl(t,e,o){const n=document.createElement("label");n.style.display="flex",n.style.alignItems="center",n.style.marginBottom="15px",n.style.cursor="pointer";const s=document.createElement("div");s.style.width="40px",s.style.height="20px",s.style.backgroundColor=e?"#4CAF50":"#ccc",s.style.borderRadius="10px",s.style.position="relative",s.style.transition="background-color 0.3s",s.style.marginRight="10px";const l=document.createElement("div");return l.style.width="18px",l.style.height="18px",l.style.backgroundColor="white",l.style.borderRadius="50%",l.style.position="absolute",l.style.top="1px",l.style.left=e?"21px":"1px",l.style.transition="left 0.3s",s.appendChild(l),n.appendChild(s),n.appendChild(document.createTextNode(t)),n.addEventListener("click",(()=>{const t="1px"===l.style.left;l.style.left=t?"21px":"1px",s.style.backgroundColor=t?"#4CAF50":"#ccc",o(t)})),n}updateSettings(t){this.settings={...this.settings,...t},this.onSettingsChange(this.settings),this.saveSettingsToStorage()}saveSettingsToStorage(){localStorage.setItem("urlifySettings",JSON.stringify(this.settings))}loadSettingsFromStorage(){const t=localStorage.getItem("urlifySettings");return t?JSON.parse(t):null}}let m={copyOutput:!1,openAsNotebook:!0,urlPath:"/lab/index.html",customUrl:null};var h=o(262);console.log("nblink extension loading from editable2 ");const y={id:"nblink",autoStart:!0,requires:[s.IDefaultFileBrowser,s.IFileBrowserFactory,n.IRouter,l.INotebookTracker],activate:async(t,e,o,n,s)=>{try{console.log("Activating nblink extension: new"),n.register({command:"notebook:start-nav",pattern:/(tempNotebook=1)/,rank:20}),function(t,e){const o=new i.ToolbarButton({label:"Save to URL",onClick:()=>{const t=e.currentWidget;console.log("in press",t,m),t&&async function(t,e,o){const n=t.context.model.toJSON();if(e.copyOutput||(n.cells=n.cells.map((t=>("code"===t.cell_type&&(t.outputs=[],t.execution_count=null),t)))),JSON.stringify(n).length>1e4){const t=await(0,i.showDialog)({title:"Large Notebook",body:"The notebook content exceeds 10,000 characters. Do you want to continue with the full content or copy only inputs?",buttons:[i.Dialog.cancelButton(),i.Dialog.okButton({label:"Full Content"}),i.Dialog.okButton({label:"Inputs Only"})]});if("Inputs Only"===t.button.label)n.cells=n.cells.map((t=>("code"===t.cell_type&&(t.outputs=[],t.execution_count=null),t)));else if(!1===t.button.accept)return}const s=r.compressToEncodedURIComponent(JSON.stringify(n));let l;if("custom"===e.urlPath&&e.customUrl)l=new URL(e.customUrl);else{const t=u(window.location.href),o=e.urlPath.replace("/notebooks/","/lab/");l=new URL(`${t}${o}`)}l.hash=`notebook=${s}`,l.searchParams.set("tempNotebook","1"),l.searchParams.set("path","temp.ipynb"),e.openAsNotebook&&l.searchParams.set("openAsNotebook","1"),console.log("new url",l.toString());const a=l.toString();i.Clipboard.copyToSystem(a),function(t,e,o=2e3){const n=document.createElement("div");n.textContent=t,n.style.position="absolute",n.style.backgroundColor="rgba(0, 0, 0, 0.7)",n.style.color="white",n.style.padding="10px 20px",n.style.borderRadius="5px",n.style.zIndex="1000",n.style.fontSize="14px";const s=e.getBoundingClientRect();n.style.top=`${s.bottom+10}px`,n.style.left=`${s.left}px`,document.body.appendChild(n),setTimeout((()=>{n.style.opacity="0",n.style.transition="opacity 0.5s ease",setTimeout((()=>document.body.removeChild(n)),500)}),o)}("Copied to clipboard",o)}(t,m,o.node)},tooltip:"Save notebook content to URL and copy to clipboard"}),n=new i.ToolbarButton({icon:a.settingsIcon,onClick:()=>{const t=new d((t=>{m=t}),m);(0,i.showDialog)({title:"Save to URL Settings",body:t,buttons:[i.Dialog.okButton()]})},tooltip:"Save to URL Settings"});e.widgetAdded.connect(((t,e)=>{console.log("added",o,n,e.toolbar),e.toolbar.insertItem(10,"saveToUrl",o),e.toolbar.insertItem(11,"settingsButton",n)}))}(0,s),function(){const t=new URLSearchParams(window.location.hash.slice(1));p=t,console.log("Saved URL parameters:",p.toString())}(),function(t,e,o,n){n&&(t.commands.addCommand("notebook:start-nav",{label:"Open Temp Notebook from URL",execute:async e=>{const{request:o}=e,s=new URL(`http://example.com${o}`).searchParams,l=s.get("tempNotebook"),i="1"===s.get("openAsNotebook"),a=async()=>{n.routed.disconnect(a),l&&"1"===l&&await t.commands.execute("notebook:open-temp",{openAsNotebook:i})};n.routed.connect(a)}}),t.commands.addCommand("notebook:open-temp",{label:"Open Temporary Notebook",execute:async n=>{var s,l;const i=null!==(s=null==o?void 0:o.tracker.currentWidget)&&void 0!==s?s:e,a=n.cwd||(null!==(l=null==i?void 0:i.model.path)&&void 0!==l?l:""),c=n.kernelId||"",d=n.kernelName||"",m=n.openAsNotebook;await(async(e,o,n,s)=>{const l=await t.commands.execute("docmanager:new-untitled",{path:e,type:"notebook"});if(void 0!==l){const e=await t.commands.execute("docmanager:open",{path:l.path,factory:"Notebook",kernel:{id:o,name:n}});e.isUntitled=!0;const i=`temp-notebook-${h.UUID.uuid4()}`;await e.context.rename(i+".ipynb");const a=function(){if(p){const t=p.get("notebook");if(t){const e=r.decompressFromEncodedURIComponent(t),o=JSON.parse(e);return console.log("decompressedContent",o),o}}return null}();return a&&(e.context.model.fromJSON(a),await e.context.save()),s&&function(t){const e=u(window.location.href),o=new URL(`${e}/notebooks/index.html`);o.searchParams.set("path",t),window.location.href=o.toString()}(e.context.path),e}})(a,c,d,m)}}))}(t,e,o,n),console.log("nblink extension activated successfully")}catch(t){console.error("Error activating nblink extension:",t)}}}}}]);