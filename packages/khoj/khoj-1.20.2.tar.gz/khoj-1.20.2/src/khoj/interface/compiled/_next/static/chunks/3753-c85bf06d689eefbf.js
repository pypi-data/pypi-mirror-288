(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3753],{23753:function(e,t,n){"use strict";n.d(t,{Z:function(){return M}});var s=n(57437),a=n(37649),l=n.n(a),r=n(2265),o=n(9557),i=n(52431),c=n(37440);let d=r.forwardRef((e,t)=>{let{className:n,value:a,indicatorColor:l,...r}=e;return(0,s.jsx)(i.fC,{ref:t,className:(0,c.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",n),...r,children:(0,s.jsx)(i.z$,{className:"h-full w-full flex-1 bg-primary transition-all ".concat(l),style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});d.displayName=i.fC.displayName,n(7395);var u=n(77574),h=n(89475),f=n(55631),m=n(5198),x=n(2861),g=n(359),p=n(13493),j=n(88145),b=n(58259),w=n(26100),v=n(35719),y=n(77689),N=n(86829),C=n(33009),k=n(42491),T=n(93146),D=n(50495),O=n(6780),S=n(19573),z=n(61485),R=n(66820),_=n(19666),E=n(58485),I=n(58575);function M(e){let[t,n]=(0,r.useState)(""),a=(0,r.useRef)(null),[i,c]=(0,r.useState)(null),[M,A]=(0,r.useState)(null),[L,Y]=(0,r.useState)(!1),[U,F]=(0,r.useState)(null),[W,H]=(0,r.useState)(!1),[K,$]=(0,r.useState)(!1),[J,P]=(0,r.useState)(null),[Z,B]=(0,r.useState)(0);function V(){if(t.trim()){if(!e.isLoggedIn){F("Hey there, you need to be signed in to send messages to Khoj AI"),H(!0);return}e.sendMessage(t.trim()),n("")}}async function X(){try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e,{mimeType:"audio/webm"}),s=[];t.ondataavailable=async e=>{s.push(e.data);let t=new Blob(s,{type:"audio/webm"}),a=new FormData;a.append("file",t);try{let e=await fetch("/api/transcribe",{method:"POST",body:a});if(!e.ok)throw Error("Network response was not ok");let t=await e.json();n(t.text.trim())}catch(e){console.error("Error sending audio to server:",e)}},t.start(1500),t.onstop=async()=>{let e=new Blob(s,{type:"audio/webm"}),a=new FormData;a.append("file",e);try{let e=await fetch("/api/transcribe",{method:"POST",body:a});if(!e.ok)throw Error("Network response was not ok");let s=await e.json();t.stream.getTracks().forEach(e=>e.stop()),P(null),n(s.text.trim())}catch(e){console.error("Error sending audio to server:",e)}},P(t)}catch(e){console.error("Error getting microphone",e)}}(0,r.useEffect)(()=>{if(L||B(0),L){let e=setInterval(()=>{B(e=>{let t=e+(Math.floor(5*Math.random())+1);return t<100?t:100})},800);return()=>clearInterval(e)}},[L]),(0,r.useEffect)(()=>{!K&&J&&J.stop(),K&&!J&&X()},[K,J]);let q=(0,r.useRef)(null);return(0,r.useEffect)(()=>{q.current&&(q.current.style.height="auto",q.current.style.height=Math.max(q.current.scrollHeight-24,64)+"px")},[t]),(0,s.jsxs)(s.Fragment,{children:[W&&U&&(0,s.jsx)(R.Z,{onOpenChange:H,loginRedirectMessage:U}),L&&(0,s.jsx)(O.aR,{open:L,children:(0,s.jsxs)(O._T,{children:[(0,s.jsx)(O.fY,{children:(0,s.jsx)(O.f$,{children:"Uploading data. Please wait."})}),(0,s.jsx)(O.yT,{children:(0,s.jsx)(d,{indicatorColor:"bg-slate-500",className:"w-full h-2 rounded-full",value:Z})}),(0,s.jsx)(O.OL,{className:"bg-slate-400 hover:bg-slate-500",onClick:()=>Y(!1),children:"Dismiss"})]})}),i&&(0,s.jsx)(O.aR,{open:null!==i,children:(0,s.jsxs)(O._T,{children:[(0,s.jsx)(O.fY,{children:(0,s.jsx)(O.f$,{children:"Data Upload Warning"})}),(0,s.jsx)(O.yT,{children:i}),(0,s.jsx)(O.OL,{className:"bg-slate-400 hover:bg-slate-500",onClick:()=>c(null),children:"Close"})]})}),M&&(0,s.jsx)(O.aR,{open:null!==M,children:(0,s.jsxs)(O._T,{children:[(0,s.jsxs)(O.fY,{children:[(0,s.jsx)(O.f$,{children:"Oh no!"}),(0,s.jsx)(O.yT,{children:"Something went wrong while uploading your data"})]}),(0,s.jsx)(O.yT,{children:M}),(0,s.jsx)(O.OL,{className:"bg-slate-400 hover:bg-slate-500",onClick:()=>A(null),children:"Close"})]})}),t.startsWith("/")&&1===t.split(" ").length&&(0,s.jsx)("div",{className:"flex justify-center text-center",children:(0,s.jsxs)(S.J2,{open:t.startsWith("/"),children:[(0,s.jsx)(z.xo,{className:"flex justify-center text-center"}),(0,s.jsx)(S.yk,{onOpenAutoFocus:e=>e.preventDefault(),className:"".concat(e.isMobileWidth?"w-[100vw]":"w-full"," rounded-md"),children:(0,s.jsxs)(k.mY,{className:"max-w-full",children:[(0,s.jsx)(k.sZ,{placeholder:"Type a command or search...",value:t,className:"hidden"}),(0,s.jsxs)(k.e8,{children:[(0,s.jsx)(k.rb,{children:"No matching commands."}),(0,s.jsx)(k.fu,{heading:"Agent Tools",children:e.chatOptionsData&&Object.entries(e.chatOptionsData).map(e=>{let[t,a]=e;return(0,s.jsx)(k.di,{className:"text-md",onSelect:()=>{n("/".concat(t," "))},children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-1",children:[(0,s.jsxs)("div",{className:"font-bold flex items-center",children:[function(e){let t="h-4 w-4 mr-2";return e.includes("summarize")?(0,s.jsx)(u.U,{className:t}):e.includes("help")?(0,s.jsx)(h.H,{className:t}):e.includes("automation")?(0,s.jsx)(f.H,{className:t}):e.includes("webpage")?(0,s.jsx)(m.A,{className:t}):e.includes("notes")?(0,s.jsx)(x.a,{className:t}):e.includes("image")?(0,s.jsx)(g.E,{className:t}):e.includes("default")?(0,s.jsx)(p.j,{className:t}):e.includes("general")?(0,s.jsx)(j.K,{className:t}):e.includes("online")?(0,s.jsx)(b.u,{className:t}):(0,s.jsx)(w.o,{className:t})}(t),"/",t]}),(0,s.jsx)("div",{children:a})]})},t)})}),(0,s.jsx)(k.zz,{})]})]})})]})}),(0,s.jsxs)("div",{className:"".concat(l().actualInputArea," items-center justify-between dark:bg-neutral-700"),children:[(0,s.jsx)("input",{type:"file",multiple:!0,ref:a,onChange:function(t){if(t.target.files){if(!e.isLoggedIn){F("Whoa! You need to login to upload files"),H(!0);return}(0,o.ko)(t.target.files,c,Y,A,e.setUploadedFiles,e.conversationId)}},style:{display:"none"}}),(0,s.jsx)(D.z,{variant:"ghost",className:"!bg-none p-0 m-2 h-auto text-3xl rounded-full text-gray-300 hover:text-gray-500",disabled:e.sendDisabled,onClick:function(){a.current&&a.current.click()},children:(0,s.jsx)(v.p,{className:"w-8 h-8"})}),(0,s.jsx)("div",{className:"grid w-full gap-1.5 relative",children:(0,s.jsx)(T.g,{ref:q,className:"border-none w-full h-16 min-h-16 max-h-[128px] md:py-4 rounded-lg resize-none dark:bg-neutral-700 ".concat(e.isMobileWidth?"text-md":"text-lg"),placeholder:"Type / to see a list of commands",id:"message",autoFocus:!0,value:t,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),V())},onChange:e=>n(e.target.value),disabled:e.sendDisabled||K})}),K?(0,s.jsx)(_.pn,{children:(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsx)(D.z,{variant:"default",className:"".concat(!K&&"hidden"," ").concat(e.agentColor?(0,I.tp)(e.agentColor):"bg-orange-300 hover:bg-orange-500"," rounded-full p-1 m-2 h-auto text-3xl transition transform md:hover:-translate-y-1"),onClick:()=>{$(!K)},disabled:e.sendDisabled,children:(0,s.jsx)(y.d,{weight:"fill",className:"w-6 h-6"})})}),(0,s.jsx)(_._v,{children:"Click to stop recording and transcribe your voice."})]})}):J?(0,s.jsx)(E.l,{}):(0,s.jsx)(_.pn,{children:(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsx)(D.z,{variant:"default",className:"".concat(!t||K||"hidden"," ").concat(e.agentColor?(0,I.tp)(e.agentColor):"bg-orange-300 hover:bg-orange-500"," rounded-full p-1 m-2 h-auto text-3xl transition transform md:hover:-translate-y-1"),onClick:()=>{n("Listening..."),$(!K)},disabled:e.sendDisabled,children:(0,s.jsx)(N.P,{weight:"fill",className:"w-6 h-6"})})}),(0,s.jsx)(_._v,{children:"Click to transcribe your message with voice."})]})}),(0,s.jsx)(D.z,{className:"".concat((!t||K)&&"hidden"," ").concat(e.agentColor?(0,I.tp)(e.agentColor):"bg-orange-300 hover:bg-orange-500"," rounded-full p-1 m-2 h-auto text-3xl transition transform md:hover:-translate-y-1"),onClick:V,disabled:e.sendDisabled,children:(0,s.jsx)(C.a,{className:"w-6 h-6",weight:"bold"})})]})]})}},66820:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(57437),a=n(6780),l=n(87138);function r(e){return(0,s.jsx)(a.aR,{open:!0,onOpenChange:e.onOpenChange,children:(0,s.jsxs)(a._T,{children:[(0,s.jsx)(a.fY,{children:(0,s.jsx)(a.f$,{children:"Sign in to Khoj to continue"})}),(0,s.jsxs)(a.yT,{children:[e.loginRedirectMessage,". By logging in, you agree to our"," ",(0,s.jsx)(l.default,{href:"https://khoj.dev/terms-of-service",children:"Terms of Service."})]}),(0,s.jsxs)(a.xo,{children:[(0,s.jsx)(a.le,{children:"Dismiss"}),(0,s.jsx)(a.OL,{className:"bg-slate-400 hover:bg-slate-500",onClick:()=>{window.location.href="/login?next=".concat(encodeURIComponent(window.location.pathname))},children:(0,s.jsxs)(l.default,{href:"/login?next=".concat(encodeURIComponent(window.location.pathname)),children:[" ","Login"]})})]})]})})}},93146:function(e,t,n){"use strict";n.d(t,{g:function(){return r}});var s=n(57437),a=n(2265),l=n(37440);let r=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...a})});r.displayName="Textarea"},19666:function(e,t,n){"use strict";n.d(t,{_v:function(){return d},aJ:function(){return c},pn:function(){return o},u:function(){return i}});var s=n(57437),a=n(2265),l=n(27071),r=n(37440);let o=l.zt,i=l.fC,c=l.xz,d=a.forwardRef((e,t)=>{let{className:n,sideOffset:a=4,...o}=e;return(0,s.jsx)(l.VY,{ref:t,sideOffset:a,className:(0,r.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...o})});d.displayName=l.VY.displayName},37649:function(e){e.exports={actualInputArea:"chatInputArea_actualInputArea__Ha6cN"}}}]);