import{g as c}from"./csrf.5.1.1.js";function m(){var n=document.getElementById("drop-area"),l=document.getElementById("fileElem"),s=document.getElementById("progress-bar"),i=document.getElementById("upload-status");n&&(n.onclick=function(){l.click()},n.addEventListener("dragover",function(t){t.preventDefault(),n.classList.add("bg-info")}),n.addEventListener("dragleave",function(t){n.classList.remove("bg-info")}),n.addEventListener("drop",function(t){t.preventDefault(),n.classList.remove("bg-info");let o=t.dataTransfer.files;o.length&&d(o[0])}),l.onchange=function(){this.files.length&&d(this.files[0])});function d(t){f(t)}function f(t){let o=new FormData;o.append("file",t);let e=new XMLHttpRequest;e.open("POST","../upload/",!0),e.setRequestHeader("X-CSRFToken",c()),e.upload.onprogress=function(r){if(r.lengthComputable){let a=r.loaded/r.total*100;s.style.width=a+"%",s.setAttribute("aria-valuenow",a),s.innerHTML=a.toFixed(0)+"%",a>99&&(i.innerHTML="Upload complete. Parsing and saving to S3...")}},e.onload=function(){if(e.status===200){let r=t.name,a=r.substring(0,r.lastIndexOf("."))||r;window.location.href=`../?highlight=${encodeURIComponent(a)}`}else console.error("Error:",e.response),i.innerHTML=e.response},e.onerror=function(){console.error("Error:",e.statusText),i.innerHTML=e.response},e.send(o)}document.getElementById("test-connection-btn").addEventListener("click",function(){var t=document.getElementById("db-connection-form"),o=new FormData(t);fetch("../validate/",{method:"POST",body:o,headers:{"X-CSRFToken":c()}}).then(e=>e.json()).then(e=>{e.success?alert("Connection successful!"):alert("Connection failed: "+e.error)}).catch(e=>console.error("Error:",e))})}export{m as setupUploads};
