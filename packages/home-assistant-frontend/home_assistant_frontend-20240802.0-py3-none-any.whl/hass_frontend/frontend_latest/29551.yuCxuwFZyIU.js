export const id=29551;export const ids=[29551,45346];export const modules={21863:(t,e,i)=>{function a(t){return void 0===t||Array.isArray(t)?t:[t]}i.d(e,{e:()=>a})},78691:(t,e,i)=>{i.a(t,(async(t,a)=>{try{i.d(e,{EO:()=>c,ol:()=>l,xo:()=>d});var s=i(35193),r=i(45269),n=t([s]);s=(n.then?(await n)():n)[0];const o=(t,e,i,a)=>{const r=i((0,s.L_)(t,e),a);return r instanceof Date?(0,s.uk)(r,e):r},l=(t,e,i,a,s)=>i.time_zone===r.Wj.server?o(t,a.time_zone,e,s):e(t,s),d=(t,e,i,a,s)=>i.time_zone===r.Wj.server?o(t,a.time_zone,e,s):e(t,s),c=(t,e,i,a,n)=>d(t,i,a,n,a.time_zone===r.Wj.server?(0,s.L_)(e,n.time_zone):e);a()}catch(t){a(t)}}))},9449:(t,e,i)=>{i.d(e,{Z:()=>s,a:()=>r});var a=i(37582);const s={ms:1,s:1e3,min:6e4,h:36e5,d:864e5},r=(t,e)=>(0,a.A)(parseFloat(t)*s[e])||"0"},37582:(t,e,i)=>{i.d(e,{A:()=>s});const a=(t,e=2)=>{let i=""+t;for(let t=1;t<e;t++)i=parseInt(i)<10**t?`0${i}`:i;return i};function s(t){const e=Math.floor(t/1e3/3600),i=Math.floor(t/1e3%3600/60),s=Math.floor(t/1e3%3600%60),r=Math.floor(t%1e3);return e>0?`${e}:${a(i)}:${a(s)}`:i>0?`${i}:${a(s)}`:s>0||r>0?`${s}${r>0?`.${a(r,3)}`:""}`:null}},96979:(t,e,i)=>{i.d(e,{I:()=>r});i(89655),i(253),i(54846),i(78266);class a{constructor(t=window.localStorage){this.storage=void 0,this._storage={},this._listeners={},this.storage=t,t===window.localStorage&&window.addEventListener("storage",(t=>{t.key&&this.hasKey(t.key)&&(this._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,this._listeners[t.key]&&this._listeners[t.key].forEach((e=>e(t.oldValue?JSON.parse(t.oldValue):t.oldValue,this._storage[t.key]))))}))}addFromStorage(t){if(!this._storage[t]){const e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}subscribeChanges(t,e){return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],()=>{this.unsubscribeChanges(t,e)}}unsubscribeChanges(t,e){if(!(t in this._listeners))return;const i=this._listeners[t].indexOf(e);-1!==i&&this._listeners[t].splice(i,1)}hasKey(t){return t in this._storage}getValue(t){return this._storage[t]}setValue(t,e){const i=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(t){}finally{this._listeners[t]&&this._listeners[t].forEach((t=>t(i,e)))}}}const s={},r=t=>e=>{const i=t.storage||"localStorage";let r;i&&i in s?r=s[i]:(r=new a(window[i]),s[i]=r);const n=String(e.key),o=t.key||String(e.key),l=e.initializer?e.initializer():void 0;r.addFromStorage(o);const d=!1!==t.subscribe?t=>r.subscribeChanges(o,((i,a)=>{t.requestUpdate(e.key,i)})):void 0,c=()=>r.hasKey(o)?t.deserializer?t.deserializer(r.getValue(o)):r.getValue(o):l;return{kind:"method",placement:"prototype",key:e.key,descriptor:{set(i){((i,a)=>{let s;t.state&&(s=c()),r.setValue(o,t.serializer?t.serializer(a):a),t.state&&i.requestUpdate(e.key,s)})(this,i)},get:()=>c(),enumerable:!0,configurable:!0},finisher(i){if(t.state&&t.subscribe){const t=i.prototype.connectedCallback,e=i.prototype.disconnectedCallback;i.prototype.connectedCallback=function(){t.call(this),this[`__unbsubLocalStorage${n}`]=d?.(this)},i.prototype.disconnectedCallback=function(){e.call(this),this[`__unbsubLocalStorage${n}`]?.(),this[`__unbsubLocalStorage${n}`]=void 0}}t.state&&i.createProperty(e.key,{noAccessor:!0,...t.stateOptions})}}}},69678:(t,e,i)=>{i.d(e,{O:()=>s,q:()=>a});const a=(t,e,i)=>Math.min(Math.max(t,e),i),s=(t,e,i)=>{let a;return a=null!=e?Math.max(t,e):t,a=null!=i?Math.min(a,i):a,a}},57636:(t,e,i)=>{i.a(t,(async(t,a)=>{try{i.d(e,{Yf:()=>c,ZQ:()=>u,ZV:()=>h,ty:()=>d,x:()=>l});var s=i(13265),r=i(45269),n=i(53249),o=t([s]);s=(o.then?(await o)():o)[0];const l=t=>d(t.attributes),d=(t,e)=>!!t.unit_of_measurement||!!t.state_class||(e||[]).includes(t.device_class||""),c=t=>{switch(t.number_format){case r.jG.comma_decimal:return["en-US","en"];case r.jG.decimal_comma:return["de","es","it"];case r.jG.space_comma:return["fr","sv","cs"];case r.jG.system:return;default:return t.language}},h=(t,e,i)=>{const a=e?c(e):void 0;return Number.isNaN=Number.isNaN||function t(e){return"number"==typeof e&&t(e)},e?.number_format===r.jG.none||Number.isNaN(Number(t))?Number.isNaN(Number(t))||""===t||e?.number_format!==r.jG.none?"string"==typeof t?t:`${(0,n.L)(t,i?.maximumFractionDigits).toString()}${"currency"===i?.style?` ${i.currency}`:""}`:new Intl.NumberFormat("en-US",_(t,{...i,useGrouping:!1})).format(Number(t)):new Intl.NumberFormat(a,_(t,i)).format(Number(t))},u=(t,e)=>{const i=e?.display_precision;return null!=i?{maximumFractionDigits:i,minimumFractionDigits:i}:Number.isInteger(Number(t?.attributes?.step))&&Number.isInteger(Number(t?.state))?{maximumFractionDigits:0}:void 0},_=(t,e)=>{const i={maximumFractionDigits:2,...e};if("string"!=typeof t)return i;if(!e||void 0===e.minimumFractionDigits&&void 0===e.maximumFractionDigits){const e=t.indexOf(".")>-1?t.split(".")[1].length:0;i.minimumFractionDigits=e,i.maximumFractionDigits=e}return i};a()}catch(t){a(t)}}))},53249:(t,e,i)=>{i.d(e,{L:()=>a});const a=(t,e=2)=>Math.round(t*10**e)/10**e},33984:(t,e,i)=>{i.d(e,{d:()=>a});const a=t=>{switch(t.language){case"cz":case"de":case"fi":case"fr":case"sk":case"sv":return" ";default:return""}}},40863:(t,e,i)=>{i.d(e,{A:()=>s});var a=i(33984);const s=(t,e)=>"Â°"===t?"":e&&"%"===t?(0,a.d)(e):" "},73207:(t,e,i)=>{i.d(e,{c:()=>_});var a=i(46999),s=i(3254),r=i(92164),n=i(213),o=i(95239),l=i(9883),d=i(61352);const c={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};let h=0;const u=new Map;function _(t,e,i){return function(t,e,i){if(!i||t===l.Hh)return(0,d.a)("--history-unavailable-color",e);if(t===l.HV)return(0,d.a)("--history-unknown-color",e);const a=(0,o.mg)(i,t);if(!a)return;const h=(0,d.a)(a,e);if(!h)return;const u=(0,n.m)(i.entity_id),_=c[u]?.[t];return _?(0,s.zm)((0,r.T)((0,s.Nc)((0,s.xp)(h)),_)):h}(t,e,i)||function(t,e){if(u.has(t))return u.get(t);const i=(0,a.fI)(h,e);return h++,u.set(t,i),i}(t,e)}},26790:(t,e,i)=>{var a=i(36312),s=i(14562),r=i(19867),n=(i(253),i(54846),i(29654),i(15112)),o=i(77706),l=i(74005),d=i(90952);(0,a.A)([(0,o.EM)("ha-button-menu")],(function(t,e){class i extends e{constructor(...e){super(...e),t(this)}}return{F:i,d:[{kind:"field",key:d.Xr,value:void 0},{kind:"field",decorators:[(0,o.MZ)()],key:"corner",value:()=>"BOTTOM_START"},{kind:"field",decorators:[(0,o.MZ)()],key:"menuCorner",value:()=>"START"},{kind:"field",decorators:[(0,o.MZ)({type:Number})],key:"x",value:()=>null},{kind:"field",decorators:[(0,o.MZ)({type:Number})],key:"y",value:()=>null},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"multi",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"activatable",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"fixed",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean,attribute:"no-anchor"})],key:"noAnchor",value:()=>!1},{kind:"field",decorators:[(0,o.P)("mwc-menu",!0)],key:"_menu",value:void 0},{kind:"get",key:"items",value:function(){return this._menu?.items}},{kind:"get",key:"selected",value:function(){return this._menu?.selected}},{kind:"method",key:"focus",value:function(){this._menu?.open?this._menu.focusItemAtIndex(0):this._triggerButton?.focus()}},{kind:"method",key:"render",value:function(){return n.qy` <div @click="${this._handleClick}"> <slot name="trigger" @slotchange="${this._setTriggerAria}"></slot> </div> <mwc-menu .corner="${this.corner}" .menuCorner="${this.menuCorner}" .fixed="${this.fixed}" .multi="${this.multi}" .activatable="${this.activatable}" .y="${this.y}" .x="${this.x}"> <slot></slot> </mwc-menu> `}},{kind:"method",key:"firstUpdated",value:function(t){(0,s.A)((0,r.A)(i.prototype),"firstUpdated",this).call(this,t),"rtl"===l.G.document.dir&&this.updateComplete.then((()=>{this.querySelectorAll("mwc-list-item").forEach((t=>{const e=document.createElement("style");e.innerHTML="span.material-icons:first-of-type { margin-left: var(--mdc-list-item-graphic-margin, 32px) !important; margin-right: 0px !important;}",t.shadowRoot.appendChild(e)}))}))}},{kind:"method",key:"_handleClick",value:function(){this.disabled||(this._menu.anchor=this.noAnchor?null:this,this._menu.show())}},{kind:"get",key:"_triggerButton",value:function(){return this.querySelector('ha-icon-button[slot="trigger"], mwc-button[slot="trigger"]')}},{kind:"method",key:"_setTriggerAria",value:function(){this._triggerButton&&(this._triggerButton.ariaHasPopup="menu")}},{kind:"get",static:!0,key:"styles",value:function(){return n.AH`:host{display:inline-block;position:relative}::slotted([disabled]){color:var(--disabled-text-color)}`}}]}}),n.WF)},37629:(t,e,i)=>{i.r(e),i.d(e,{HaCircularProgress:()=>d});var a=i(36312),s=i(14562),r=i(19867),n=i(99322),o=i(15112),l=i(77706);let d=(0,a.A)([(0,l.EM)("ha-circular-progress")],(function(t,e){class i extends e{constructor(...e){super(...e),t(this)}}return{F:i,d:[{kind:"field",decorators:[(0,l.MZ)({attribute:"aria-label",type:String})],key:"ariaLabel",value:()=>"Loading"},{kind:"field",decorators:[(0,l.MZ)()],key:"size",value:()=>"medium"},{kind:"method",key:"updated",value:function(t){if((0,s.A)((0,r.A)(i.prototype),"updated",this).call(this,t),t.has("size"))switch(this.size){case"tiny":this.style.setProperty("--md-circular-progress-size","16px");break;case"small":this.style.setProperty("--md-circular-progress-size","28px");break;case"medium":this.style.setProperty("--md-circular-progress-size","48px");break;case"large":this.style.setProperty("--md-circular-progress-size","68px")}}},{kind:"field",static:!0,key:"styles",value(){return[...(0,s.A)((0,r.A)(i),"styles",this),o.AH`:host{--md-sys-color-primary:var(--primary-color);--md-circular-progress-size:48px}`]}}]}}),n.U)},45346:(t,e,i)=>{i.r(e),i.d(e,{HaIconButtonArrowPrev:()=>o});var a=i(36312),s=i(15112),r=i(77706),n=i(74005);i(28066);let o=(0,a.A)([(0,r.EM)("ha-icon-button-arrow-prev")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,r.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,r.MZ)({type:Boolean})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,r.MZ)()],key:"label",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_icon",value:()=>"rtl"===n.G.document.dir?"M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z":"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"},{kind:"method",key:"render",value:function(){return s.qy` <ha-icon-button .disabled="${this.disabled}" .label="${this.label||this.hass?.localize("ui.common.back")||"Back"}" .path="${this._icon}"></ha-icon-button> `}}]}}),s.WF)},50808:(t,e,i)=>{var a=i(36312),s=i(11514),r=i(21025),n=i(15112),o=i(77706);(0,a.A)([(0,o.EM)("ha-top-app-bar-fixed")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",static:!0,key:"styles",value:()=>[r.R,n.AH`.mdc-top-app-bar__row{height:var(--header-height);border-bottom:var(--app-header-border-bottom)}.mdc-top-app-bar--fixed-adjust{padding-top:var(--header-height)}.mdc-top-app-bar{--mdc-typography-headline6-font-weight:400;color:var(--app-header-text-color,var(--mdc-theme-on-primary,#fff));background-color:var(--app-header-background-color,var(--mdc-theme-primary))}.mdc-top-app-bar__title{padding-inline-start:20px;padding-inline-end:initial}`]}]}}),s.$)},50118:(t,e,i)=>{function a(t){return"strategy"in t}i.d(e,{Dz:()=>s,Wu:()=>a,io:()=>n,ql:()=>r});const s=(t,e,i)=>t.sendMessagePromise({type:"lovelace/config",url_path:e,force:i}),r=(t,e,i)=>t.callWS({type:"lovelace/config/save",url_path:e,config:i}),n=(t,e)=>t.callWS({type:"lovelace/config/delete",url_path:e})},57216:(t,e,i)=>{i.d(e,{A_:()=>n,SJ:()=>a,mQ:()=>r,n6:()=>s});const a=t=>t.callWS({type:"lovelace/dashboards/list"}),s=(t,e)=>t.callWS({type:"lovelace/dashboards/create",...e}),r=(t,e,i)=>t.callWS({type:"lovelace/dashboards/update",dashboard_id:e,...i}),n=(t,e)=>t.callWS({type:"lovelace/dashboards/delete",dashboard_id:e})},29829:(t,e,i)=>{i.d(e,{DF:()=>_,Lo:()=>v,MH:()=>d,MM:()=>g,Qz:()=>u,Ru:()=>y,UU:()=>f,_7:()=>h,bZ:()=>c,m0:()=>l,tD:()=>p,vX:()=>m});i(89655),i(253),i(2075),i(32137),i(54846),i(4525),i(19588),i(40322),i(41499),i(3714),i(64961),i(62726),i(19192);var a=i(21863),s=i(65459),r=i(42496),n=i(57273),o=i(10725);const l=(t,e,i,a,s,r,n)=>{const o=[],l=[],d=[];return Object.values(i).forEach((i=>{i.labels.includes(e)&&u(t,s,a,i.area_id,r,n)&&d.push(i.area_id)})),Object.values(a).forEach((i=>{i.labels.includes(e)&&_(t,Object.values(s),i,r,n)&&l.push(i.id)})),Object.values(s).forEach((i=>{i.labels.includes(e)&&g(t.states[i.entity_id],r,n)&&o.push(i.entity_id)})),{areas:d,devices:l,entities:o}},d=(t,e,i,a,s)=>{const r=[];return Object.values(i).forEach((i=>{i.floor_id===e&&u(t,t.entities,t.devices,i.area_id,a,s)&&r.push(i.area_id)})),{areas:r}},c=(t,e,i,a,s,r)=>{const n=[],o=[];return Object.values(i).forEach((i=>{i.area_id===e&&_(t,Object.values(a),i,s,r)&&o.push(i.id)})),Object.values(a).forEach((i=>{i.area_id===e&&g(t.states[i.entity_id],s,r)&&n.push(i.entity_id)})),{devices:o,entities:n}},h=(t,e,i,a,s)=>{const r=[];return Object.values(i).forEach((i=>{i.device_id===e&&g(t.states[i.entity_id],a,s)&&r.push(i.entity_id)})),{entities:r}},u=(t,e,i,a,s,r)=>!!Object.values(i).some((i=>!(i.area_id!==a||!_(t,Object.values(e),i,s,r))))||Object.values(e).some((e=>!(e.area_id!==a||!g(t.states[e.entity_id],s,r)))),_=(t,e,i,s,r)=>{const n=r?(0,o.fk)(r,e):void 0;if(s.target?.device&&!(0,a.e)(s.target.device).some((t=>m(t,i,n))))return!1;if(s.target?.entity){return e.filter((t=>t.device_id===i.id)).some((e=>{const i=t.states[e.entity_id];return g(i,s,r)}))}return!0},g=(t,e,i)=>!e.target?.entity||(0,a.e)(e.target.entity).some((e=>y(e,t,i))),m=(t,e,i)=>{const{manufacturer:a,model:s,integration:r}=t;return(!a||e.manufacturer===a)&&((!s||e.model===s)&&!(r&&i&&!i?.[e.id]?.has(r)))},y=(t,e,i)=>{const{domain:n,device_class:o,supported_features:l,integration:d}=t;if(n){const t=(0,s.t)(e);if(Array.isArray(n)?!n.includes(t):t!==n)return!1}if(o){const t=e.attributes.device_class;if(t&&Array.isArray(o)?!o.includes(t):t!==o)return!1}return!(l&&!(0,a.e)(l).some((t=>(0,r.$)(e,t))))&&(!d||i?.[e.entity_id]?.domain===d)},f=t=>{if(!t.entity)return{entity:null};if("filter"in t.entity)return t;const{domain:e,integration:i,device_class:a,...s}=t.entity;return e||i||a?{entity:{...s,filter:{domain:e,integration:i,device_class:a}}}:{entity:s}},p=t=>{if(!t.device)return{device:null};if("filter"in t.device)return t;const{integration:e,manufacturer:i,model:a,...s}=t.device;return e||i||a?{device:{...s,filter:{integration:e,manufacturer:i,model:a}}}:{device:s}},v=t=>{let e;if("target"in t)e=(0,a.e)(t.target?.entity);else if("entity"in t){if(t.entity?.include_entities)return;e=(0,a.e)(t.entity?.filter)}if(!e)return;const i=e.flatMap((t=>t.integration||t.device_class||t.supported_features||!t.domain?[]:(0,a.e)(t.domain).filter((t=>(0,n.z)(t)))));return[...new Set(i)]}},57273:(t,e,i)=>{i.d(e,{L:()=>s,z:()=>r});var a=i(99890);const s=["input_boolean","input_button","input_text","input_number","input_datetime","input_select","counter","timer","schedule"],r=(0,a.g)(s)},11577:(t,e,i)=>{i.a(t,(async(t,a)=>{try{i.r(e);var s=i(36312),r=i(14562),n=i(19867),o=(i(89655),i(253),i(94438),i(54846),i(16891),i(19588),i(40322),i(41499),i(3714),i(64961),i(62726),i(19192),i(74860),i(71011),i(71174),i(6711)),l=i(15112),d=i(77706),c=i(94100),h=i(21863),u=i(96979),_=i(213),g=i(16312),m=i(20732),y=i(56932),f=i(90701),p=i(4159),v=(i(37629),i(9043)),k=(i(28066),i(26790),i(13830),i(45346),i(11804),i(79998),i(50808),i(11630)),b=i(4826),w=i(29829),H=i(96778),x=i(6121),$=i(55321),A=i(30489),D=i(7950),L=t([p,v,k]);[p,v,k]=L.then?(await L)():L;const M="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",C="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",S="M14.76,20.83L17.6,18L14.76,15.17L16.17,13.76L19,16.57L21.83,13.76L23.24,15.17L20.43,18L23.24,20.83L21.83,22.24L19,19.4L16.17,22.24L14.76,20.83M12,12V19.88C12.04,20.18 11.94,20.5 11.71,20.71C11.32,21.1 10.69,21.1 10.3,20.71L8.29,18.7C8.06,18.47 7.96,18.16 8,17.87V12H7.97L2.21,4.62C1.87,4.19 1.95,3.56 2.38,3.22C2.57,3.08 2.78,3 3,3V3H17V3C17.22,3 17.43,3.08 17.62,3.22C18.05,3.56 18.13,4.19 17.79,4.62L12.03,12H12Z",V="M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z";let z=(0,s.A)(null,(function(t,e){class i extends e{constructor(){super(),t(this);const e=new Date;e.setHours(e.getHours()-1,0,0,0),this._startDate=e;const i=new Date;i.setHours(i.getHours()+2,0,0,0),this._endDate=i}}return{F:i,d:[{kind:"field",decorators:[(0,d.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,d.MZ)({reflect:!0,type:Boolean})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,d.MZ)({reflect:!0,type:Boolean})],key:"rtl",value:()=>!1},{kind:"field",decorators:[(0,d.wk)()],key:"_startDate",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_endDate",value:void 0},{kind:"field",decorators:[(0,u.I)({key:"historyPickedValue",state:!0,subscribe:!1})],key:"_targetPickerValue",value:()=>({})},{kind:"field",decorators:[(0,d.wk)()],key:"_isLoading",value:()=>!1},{kind:"field",decorators:[(0,d.wk)()],key:"_stateHistory",value:void 0},{kind:"field",key:"_mungedStateHistory",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_statisticsHistory",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_showBack",value:void 0},{kind:"field",decorators:[(0,d.P)("state-history-charts")],key:"_stateHistoryCharts",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"field",key:"_interval",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,r.A)((0,n.A)(i.prototype),"connectedCallback",this).call(this),this.hasUpdated&&this._getHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,r.A)((0,n.A)(i.prototype),"disconnectedCallback",this).call(this),this._unsubscribeHistory()}},{kind:"method",key:"_goBack",value:function(){history.back()}},{kind:"method",key:"render",value:function(){const t=this._getEntityIds().length>0;return l.qy` <ha-top-app-bar-fixed> ${this._showBack?l.qy` <ha-icon-button-arrow-prev slot="navigationIcon" @click="${this._goBack}"></ha-icon-button-arrow-prev> `:l.qy` <ha-menu-button slot="navigationIcon" .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> `} <div slot="title">${this.hass.localize("panel.history")}</div> ${t?l.qy` <ha-icon-button slot="actionItems" @click="${this._removeAll}" .disabled="${this._isLoading}" .path="${S}" .label="${this.hass.localize("ui.panel.history.remove_all")}"></ha-icon-button> `:""} <ha-button-menu slot="actionItems" @action="${this._handleMenuAction}"> <ha-icon-button slot="trigger" .label="${this.hass.localize("ui.common.menu")}" .path="${M}"></ha-icon-button> <ha-list-item graphic="icon" .disabled="${this._isLoading}"> ${this.hass.localize("ui.panel.history.download_data")} <ha-svg-icon slot="graphic" .path="${C}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="${this._isLoading}"> ${this.hass.localize("ui.panel.history.add_card")} <ha-svg-icon slot="graphic" .path="${V}"></ha-svg-icon> </ha-list-item> </ha-button-menu> <div class="flex content"> <div class="filters"> <ha-date-range-picker .hass="${this.hass}" ?disabled="${this._isLoading}" .startDate="${this._startDate}" .endDate="${this._endDate}" extendedPresets @change="${this._dateRangeChanged}"></ha-date-range-picker> <ha-target-picker .hass="${this.hass}" .value="${this._targetPickerValue}" .disabled="${this._isLoading}" addOnTop @value-changed="${this._targetsChanged}"></ha-target-picker> </div> ${this._isLoading?l.qy`<div class="progress-wrapper"> <ha-circular-progress indeterminate></ha-circular-progress> </div>`:t?l.qy` <state-history-charts .hass="${this.hass}" .historyData="${this._mungedStateHistory}" .startTime="${this._startDate}" .endTime="${this._endDate}"> </state-history-charts> `:l.qy`<div class="start-search"> ${this.hass.localize("ui.panel.history.start_search")} </div>`} </div> </ha-top-app-bar-fixed> `}},{kind:"method",key:"mergeHistoryResults",value:function(t,e){const i={...e,line:[]},a={};for(const t of e.line){const e=(0,k.qc)(t.unit,t.device_class,!0);e&&(a[e]={historyItem:t})}for(const e of t.line){const t=(0,k.qc)(e.unit,e.device_class,!0);t&&(t in a?a[t].ltsItem=e:a[t]={ltsItem:e})}for(const{historyItem:t,ltsItem:e}of Object.values(a)){if(!t||!e){i.line.push(t||e);continue}const a={...t,data:[]},s=new Set([...t.data.map((t=>t.entity_id)),...e.data.map((t=>t.entity_id))]);for(const i of s){const s=t.data.find((t=>t.entity_id===i)),r=e.data.find((t=>t.entity_id===i));if(!s||!r){a.data.push(s||r);continue}const n=s.states[0]?.last_changed||r.statistics[r.statistics.length-1].last_changed+1,o=[];for(const t of r.statistics){if(t.last_changed>=n)break;o.push(t)}a.data.push(0===o.length?s:{...s,statistics:o})}i.line.push(a)}return i}},{kind:"method",key:"willUpdate",value:function(t){if((0,r.A)((0,n.A)(i.prototype),"willUpdate",this).call(this,t),(t.has("_stateHistory")||t.has("_statisticsHistory")||t.has("_startDate")||t.has("_endDate")||t.has("_targetPickerValue"))&&(this._statisticsHistory&&this._stateHistory?this._mungedStateHistory=this.mergeHistoryResults(this._statisticsHistory,this._stateHistory):this._mungedStateHistory=this._stateHistory||this._statisticsHistory),this.hasUpdated)return;const e=(0,y.px)(),a=e.entity_id,s=e.device_id,o=e.area_id,l=e.floor_id,d=e.label_id;if((a||s||o||l||d)&&(this._targetPickerValue={}),a){const t=a.split(",");this._targetPickerValue.entity_id=t}if(s){const t=s.split(",");this._targetPickerValue.device_id=t}if(o){const t=o.split(",");this._targetPickerValue.area_id=t}if(l){const t=l.split(",");this._targetPickerValue.floor_id=t}if(d){const t=d.split(",");this._targetPickerValue.label_id=t}const c=e.start_date;c&&(this._startDate=new Date(c));const h=e.end_date;h&&(this._endDate=new Date(h))}},{kind:"method",key:"firstUpdated",value:function(t){(0,r.A)((0,n.A)(i.prototype),"firstUpdated",this).call(this,t);"1"===(0,y.px)().back&&history.length>1&&(this._showBack=!0,(0,g.o)((0,m.Z)((0,y.s8)("back")),{replace:!0}))}},{kind:"method",key:"updated",value:function(t){(t.has("_startDate")||t.has("_endDate")||t.has("_targetPickerValue")||!this._stateHistory&&(t.has("_deviceEntityLookup")||t.has("_areaEntityLookup")||t.has("_areaDeviceLookup")))&&(this._getHistory(),this._getStats())}},{kind:"method",key:"_removeAll",value:function(){this._targetPickerValue={},this._updatePath()}},{kind:"method",key:"_getStats",value:async function(){const t=this._getEntityIds();if(0===t.length)return void(this._statisticsHistory=void 0);const e=await(0,b.sz)(this.hass,this._startDate,this._endDate,t,"hour",void 0,["mean","state"]),i={};t.forEach((t=>{t in e&&(i[t]=e[t])}));const a={};Object.entries(i).forEach((([t,e])=>{const i=e.map((t=>({s:null!=t.mean?t.mean.toString():t.state.toString(),lc:t.start/1e3,a:{},lu:t.start/1e3})));a[t]=i}));const{numeric_device_classes:s}=await(0,H.KL)(this.hass);this._statisticsHistory=(0,k.Mm)(this.hass,a,[],this.hass.localize,s,!0,!0),(this._statisticsHistory?.line||[]).forEach((t=>{t.data.forEach((t=>{t.statistics=t.states,t.states=[]}))}))}},{kind:"method",key:"_getHistory",value:async function(){const t=this._getEntityIds();if(0===t.length)return void(this._stateHistory=void 0);this._isLoading=!0,this._subscribed&&this._unsubscribeHistory();const e=new Date,{numeric_device_classes:i}=await(0,H.KL)(this.hass);this._subscribed=(0,k.Jo)(this.hass,(e=>{this._isLoading=!1,this._stateHistory=(0,k.Mm)(this.hass,e,t,this.hass.localize,i,!0)}),this._startDate,this._endDate,t),this._subscribed.catch((()=>{this._isLoading=!1,this._unsubscribeHistory()})),this._endDate>e&&this._setRedrawTimer()}},{kind:"method",key:"_setRedrawTimer",value:function(){clearInterval(this._interval);const t=new Date,e=this._endDate>t?t:this._endDate,i=(0,o.M)(e,this._startDate);this._interval=window.setInterval((()=>this._stateHistoryCharts?.requestUpdate()),i<2?1e4:i<10?6e4:f.p)}},{kind:"method",key:"_unsubscribeHistory",value:function(){this._interval&&(clearInterval(this._interval),this._interval=void 0),this._subscribed&&(this._subscribed.then((t=>t?.())),this._subscribed=void 0)}},{kind:"method",key:"_getEntityIds",value:function(){return this.__getEntityIds(this._targetPickerValue,this.hass.entities,this.hass.devices,this.hass.areas)}},{kind:"field",key:"__getEntityIds",value(){return(0,c.A)(((t,e,i,a)=>{if(!t)return[];const s={target:{}},r=new Set((0,h.e)(t.entity_id)),n=new Set((0,h.e)(t.device_id)),o=new Set((0,h.e)(t.area_id)),l=new Set((0,h.e)(t.floor_id));return new Set((0,h.e)(t.label_id)).forEach((t=>{const l=(0,w.m0)(this.hass,t,a,i,e,s);l.devices.forEach((t=>n.add(t))),l.entities.forEach((t=>r.add(t))),l.areas.forEach((t=>o.add(t)))})),l.forEach((t=>{(0,w.MH)(this.hass,t,a,s).areas.forEach((t=>o.add(t)))})),o.forEach((t=>{const a=(0,w.bZ)(this.hass,t,i,e,s);a.devices.forEach((t=>n.add(t))),a.entities.forEach((t=>r.add(t)))})),n.forEach((t=>{(0,w._7)(this.hass,t,e,s).entities.forEach((t=>r.add(t)))})),Array.from(r)}))}},{kind:"method",key:"_dateRangeChanged",value:function(t){this._startDate=t.detail.startDate;const e=t.detail.endDate;0===e.getHours()&&0===e.getMinutes()&&(e.setDate(e.getDate()+1),e.setMilliseconds(e.getMilliseconds()-1)),this._endDate=e,this._updatePath()}},{kind:"method",key:"_targetsChanged",value:function(t){this._targetPickerValue=t.detail.value||{},this._updatePath()}},{kind:"method",key:"_updatePath",value:function(){const t={};this._targetPickerValue.entity_id&&(t.entity_id=(0,h.e)(this._targetPickerValue.entity_id).join(",")),this._targetPickerValue.label_id&&(t.label_id=(0,h.e)(this._targetPickerValue.label_id).join(",")),this._targetPickerValue.floor_id&&(t.floor_id=(0,h.e)(this._targetPickerValue.floor_id).join(",")),this._targetPickerValue.area_id&&(t.area_id=(0,h.e)(this._targetPickerValue.area_id).join(",")),this._targetPickerValue.device_id&&(t.device_id=(0,h.e)(this._targetPickerValue.device_id).join(",")),this._startDate&&(t.start_date=this._startDate.toISOString()),this._endDate&&(t.end_date=this._endDate.toISOString()),(0,g.o)(`/history?${(0,y.KH)(t)}`,{replace:!0})}},{kind:"method",key:"_handleMenuAction",value:async function(t){switch(t.detail.index){case 0:this._downloadHistory();break;case 1:this._suggestCard()}}},{kind:"method",key:"_downloadHistory",value:function(){if(0===[...this._getEntityIds()].sort().length||!this._mungedStateHistory)return void(0,x.showAlertDialog)(this,{title:this.hass.localize("ui.panel.history.download_data_error"),text:this.hass.localize("ui.panel.history.error_no_data"),warning:!0});const t=[""],e=["entity_id","state","last_changed"],i=new Set,a={climate:{current_temperature:0,hvac_action:0,target_temp_high:0,target_temp_low:0,temperature:0},humidifier:{action:0,current_humidity:0,humidity:0},water_heater:{current_temperature:0,operation_mode:0,temperature:0}},s=t=>new Date(t).toISOString();for(const r of this._mungedStateHistory.line)for(const n of r.data){const r=n.entity_id,o=(0,_.m)(r),l=a[o];if(l&&!i.has(o)){i.add(o);let t=e.length;for(const i of Object.keys(l))e.push(i),l[i]=t,t+=1}if(n.statistics)for(const e of n.statistics)t.push(`${r},${e.state},${s(e.last_changed)}\n`);for(const e of n.states){const i=s(e.last_changed),a=[r,e.state,i];if(e.attributes&&l){const t=e.attributes;for(const[e,i]of Object.entries(l))e in t&&(a[i]=t[e])}t.push(a.join(",")+"\n")}}for(const e of this._mungedStateHistory.timeline){const i=e.entity_id;for(const a of e.data){const e=/,|"/.test(a.state)?`"${a.state.replaceAll('"','""')}"`:a.state;t.push(`${i},${e},${s(a.last_changed)}\n`)}}t[0]=e.join(",")+"\n";const r=new Blob(t,{type:"text/csv"}),n=window.URL.createObjectURL(r);(0,A.R)(n,"history.csv")}},{kind:"method",key:"_suggestCard",value:function(){const t=this._getEntityIds();if(0===t.length||!this._mungedStateHistory)return void(0,x.showAlertDialog)(this,{title:this.hass.localize("ui.panel.history.add_card_error"),text:this.hass.localize("ui.panel.history.error_no_data"),warning:!0});const e=Math.min(this._endDate.getTime(),Date.now()),i=[{title:this.hass.localize("panel.history"),type:"history-graph",hours_to_show:Math.round((e-this._startDate.getTime())/1e3/60/60),entities:t}];(0,D.Q)(this,this.hass,i,{title:this.hass.localize("panel.history"),cards:i},t)}},{kind:"get",static:!0,key:"styles",value:function(){return[$.RF,l.AH`.content{padding:0 16px 16px;padding-bottom:max(env(safe-area-inset-bottom),16px)}:host([virtualize]){height:100%}.progress-wrapper{position:relative;display:flex;align-items:center;flex-direction:column;padding:16px}.filters{display:flex;align-items:flex-start;margin-top:16px}ha-date-range-picker{margin-right:16px;margin-inline-end:16px;margin-inline-start:initial;max-width:100%;direction:var(--direction)}@media all and (max-width:1025px){.filters{flex-direction:column}ha-date-range-picker{margin-right:0;margin-inline-end:0;margin-inline-start:initial;width:100%}}.start-search{padding-top:16px;text-align:center;color:var(--secondary-text-color)}`]}}]}}),l.WF);customElements.define("ha-panel-history",z),a()}catch(t){a(t)}}))},7950:(t,e,i)=>{i.d(e,{Q:()=>l});i(253),i(2075);var a=i(50118),s=i(57216),r=i(6121),n=i(84048),o=i(45111);const l=async(t,e,i,l,d)=>{e.loadFragmentTranslation("lovelace");const c=await(0,s.SJ)(e),h=c.filter((t=>"storage"===t.mode)),u=e.panels.lovelace?.config?.mode;if("storage"!==u&&!h.length)return void(0,n.Q)(t,{cardConfig:i,entities:d,yaml:!0});let _,g=null;if("storage"===u)try{_=await(0,a.Dz)(e.connection,null,!1)}catch(t){}if(!_&&h.length)for(const t of h)try{_=await(0,a.Dz)(e.connection,t.url_path,!1),g=t.url_path;break}catch(t){}_?h.length||_.views?.length?h.length||1!==_.views.length?(0,o.X)(t,{lovelaceConfig:_,urlPath:g,allowDashboardChange:!0,actionLabel:e.localize("ui.common.next"),dashboards:c,viewSelectedCallback:(s,r,o)=>{(0,n.Q)(t,{cardConfig:i,sectionConfig:l,lovelaceConfig:r,saveConfig:async t=>{try{await(0,a.ql)(e,s,t)}catch{alert(e.localize("ui.panel.lovelace.add_entities.saving_failed"))}},path:[o],entities:d})}}):(0,n.Q)(t,{cardConfig:i,sectionConfig:l,lovelaceConfig:_,saveConfig:async t=>{try{await(0,a.ql)(e,null,t)}catch(t){alert(e.localize("ui.panel.lovelace.add_entities.saving_failed"))}},path:[0],entities:d}):(0,r.showAlertDialog)(t,{text:"You don't have any Lovelace views, first create a view in Lovelace."}):c.length>h.length?(0,n.Q)(t,{cardConfig:i,sectionConfig:l,entities:d,yaml:!0}):(0,r.showAlertDialog)(t,{text:"You don't seem to be in control of any dashboard, please take control first."})}},84048:(t,e,i)=>{i.d(e,{Q:()=>r});var a=i(34897);const s=()=>Promise.all([i.e(24500),i.e(61060),i.e(70252),i.e(51431),i.e(91545),i.e(71580),i.e(66419),i.e(73767),i.e(29842),i.e(81625),i.e(39971),i.e(19521),i.e(34708),i.e(73682),i.e(69743),i.e(1719),i.e(23551),i.e(71743),i.e(37183)]).then(i.bind(i,80675)),r=(t,e)=>{(0,a.r)(t,"show-dialog",{dialogTag:"hui-dialog-suggest-card",dialogImport:s,dialogParams:e})}},45111:(t,e,i)=>{i.d(e,{X:()=>s});var a=i(34897);const s=(t,e)=>{(0,a.r)(t,"show-dialog",{dialogTag:"hui-dialog-select-view",dialogImport:()=>Promise.all([i.e(10963),i.e(14691),i.e(24500),i.e(3051),i.e(53779)]).then(i.bind(i,53779)),dialogParams:e})}},30489:(t,e,i)=>{i.d(e,{R:()=>a});const a=(t,e="")=>{const i=document.createElement("a");i.target="_blank",i.href=t,i.download=e,document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click")),document.body.removeChild(i)}}};
//# sourceMappingURL=29551.yuCxuwFZyIU.js.map