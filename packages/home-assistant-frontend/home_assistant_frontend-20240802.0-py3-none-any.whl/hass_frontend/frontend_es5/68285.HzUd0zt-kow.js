"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[68285],{77226:function(t,e,i){i.d(e,{A:function(){return o}});i(71499),i(28552),i(36016),i(55228),i(43037);var n=function(t){var e=parseFloat(t);if(isNaN(e))throw new Error("".concat(t," is not a number"));return e};function o(t){if(!t)return null;try{if(t.endsWith("%"))return{w:100,h:n(t.substr(0,t.length-1))};var e=t.replace(":","x").split("x");return 0===e.length?null:1===e.length?{w:n(e[0]),h:1}:{w:n(e[0]),h:n(e[1])}}catch(i){}return null}},29399:function(t,e,i){var n=i(22858).A,o=i(33994).A;i.a(t,function(){var t=n(o().mark((function t(n,r){var s,a,u,c,h,d,l,f,_,v,g,k,m,p,y,b,w,A,E,H,x,M,C,V,D,F,z,O,P,S,U,I,N,Z,B,L,R,T,W,j,q,Q,Y,G,J,K,X,$,tt,et,it,nt,ot;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i.r(e),i.d(e,{DEFAULT_HOURS_TO_SHOW:function(){return nt},DEFAULT_ZOOM:function(){return ot}}),s=i(64782),a=i(41981),u=i(64599),c=i(33994),h=i(22858),d=i(35806),l=i(71008),f=i(62193),_=i(2816),v=i(27927),g=i(14562),k=i(19867),m=i(71499),p=i(81027),y=i(44124),b=i(82386),w=i(95737),A=i(97741),E=i(89655),H=i(50693),x=i(29193),M=i(82115),C=i(10507),V=i(39790),D=i(9241),F=i(66457),z=i(36604),O=i(99019),P=i(253),S=i(94438),U=i(16891),I=i(96858),N=i(15112),Z=i(29818),B=i(94100),L=i(46999),R=i(33922),T=i(213),W=i(19244),j=i(16569),q=i(77226),i(13082),i(13292),i(28066),Q=i(4712),Y=i(11630),G=i(7934),J=i(18102),K=i(62241),!(X=n([Q,Y])).then){t.next=80;break}return t.next=76,X;case 76:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=81;break;case 80:t.t0=X;case 81:$=t.t0,Q=$[0],Y=$[1],nt=0,ot=14,(0,v.A)([(0,Z.EM)("hui-map-card")],(function(t,e){var n,o=function(e){function i(){var e;(0,l.A)(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return e=(0,f.A)(this,i,[].concat(o)),t(e),e}return(0,_.A)(i,e),(0,d.A)(i)}(e);return{F:o,d:[{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"layout",value:void 0},{kind:"field",decorators:[(0,Z.wk)()],key:"_stateHistory",value:void 0},{kind:"field",decorators:[(0,Z.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,Z.P)("ha-map")],key:"_map",value:void 0},{kind:"field",key:"_configEntities",value:void 0},{kind:"field",decorators:[(0,Z.wk)()],key:"_mapEntities",value:function(){return[]}},{kind:"field",key:"_colorDict",value:function(){return{}}},{kind:"field",key:"_colorIndex",value:function(){return 0}},{kind:"field",decorators:[(0,Z.wk)()],key:"_error",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"method",key:"setConfig",value:function(t){var e;if(!t)throw new Error("Error in card configuration.");if(!(null!==(e=t.entities)&&void 0!==e&&e.length||t.geo_location_sources))throw new Error("Either entities or geo_location_sources must be specified");if(t.entities&&!Array.isArray(t.entities))throw new Error("Entities need to be an array");if(t.geo_location_sources&&!Array.isArray(t.geo_location_sources))throw new Error("Parameter geo_location_sources needs to be an array");this._config=t,this._configEntities=t.entities?(0,K.L)(t.entities):[],this._mapEntities=this._getMapEntities()}},{kind:"method",key:"getCardSize",value:function(){var t;if(null===(t=this._config)||void 0===t||!t.aspect_ratio)return 7;var e=(0,q.A)(this._config.aspect_ratio),i=e&&e.w>0&&e.h>0?"".concat((100*e.h/e.w).toFixed(2)):"100";return 1+Math.floor(Number(i)/25)||3}},{kind:"method",static:!0,key:"getConfigElement",value:(n=(0,h.A)((0,c.A)().mark((function t(){return(0,c.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([i.e(94131),i.e(40319),i.e(7726),i.e(9421),i.e(55792),i.e(94548),i.e(71545),i.e(42121)]).then(i.bind(i,57396));case 2:return t.abrupt("return",document.createElement("hui-map-card-editor"));case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{kind:"method",static:!0,key:"getStubConfig",value:function(t,e,i){return{type:"map",entities:(0,J.B)(t,2,e,i,["device_tracker"]),theme_mode:"auto"}}},{kind:"method",key:"render",value:function(){var t;if(!this._config)return N.s6;if(this._error)return(0,N.qy)(tt||(tt=(0,u.A)(['<ha-alert alert-type="error"> ',": "," (",") </ha-alert>"])),this.hass.localize("ui.components.map.error"),this._error.message,this._error.code);var e=!(!this._config.dark_mode&&"dark"!==this._config.theme_mode)||"light"!==this._config.theme_mode&&this.hass.themes.darkMode,i=this._config.theme_mode||(this._config.dark_mode?"dark":"auto");return(0,N.qy)(et||(et=(0,u.A)([' <ha-card id="card" .header="','"> <div id="root"> <ha-map .hass="','" .entities="','" .zoom="','" .paths="','" .autoFit="','" .fitZones="','" .themeMode="','" interactiveZones renderPassive></ha-map> <ha-icon-button .label="','" .path="','" style="','" @click="','" tabindex="0"></ha-icon-button> </div> </ha-card> '])),this._config.title,this.hass,this._mapEntities,null!==(t=this._config.default_zoom)&&void 0!==t?t:ot,this._getHistoryPaths(this._config,this._stateHistory),this._config.auto_fit||!1,this._config.fit_zones,i,this.hass.localize("ui.panel.lovelace.cards.map.reset_focus"),"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M19,19H15V21H19A2,2 0 0,0 21,19V15H19M19,3H15V5H19V9H21V5A2,2 0 0,0 19,3M5,5H9V3H5A2,2 0 0,0 3,5V9H5M5,15H3V19A2,2 0 0,0 5,21H9V19H5V15Z",e?"color:#ffffff":"color:#000000",this._fitMap)}},{kind:"method",key:"shouldUpdate",value:function(t){var e,i;if(!t.has("hass")||t.size>1)return!0;var n=t.get("hass");return!n||!this._configEntities||(n.themes.darkMode!==this.hass.themes.darkMode||(!!t.has("_stateHistory")||(!(null===(e=this._config)||void 0===e||!e.geo_location_sources||n.states===this.hass.states)||(null!==(i=this._config)&&void 0!==i&&i.entities?(0,G.pY)(this,t):(0,G.xP)(this,t)))))}},{kind:"method",key:"willUpdate",value:function(t){var e,i;(0,g.A)((0,k.A)(o.prototype),"willUpdate",this).call(this,t),t.has("hass")&&null!==(e=this._config)&&void 0!==e&&e.geo_location_sources&&!(0,j.b)(this._getSourceEntities(null===(i=t.get("hass"))||void 0===i?void 0:i.states),this._getSourceEntities(this.hass.states))&&(this._mapEntities=this._getMapEntities())}},{kind:"method",key:"connectedCallback",value:function(){var t;(0,g.A)((0,k.A)(o.prototype),"connectedCallback",this).call(this),this.hasUpdated&&null!==(t=this._configEntities)&&void 0!==t&&t.length&&this._subscribeHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,g.A)((0,k.A)(o.prototype),"disconnectedCallback",this).call(this),this._unsubscribeHistory()}},{kind:"method",key:"_subscribeHistory",value:function(){var t,e,i,n=this;(0,R.x)(this.hass,"history")&&!this._subscribed&&(null!==(t=null===(e=this._config)||void 0===e?void 0:e.hours_to_show)&&void 0!==t?t:nt)&&(this._subscribed=(0,Y.IQ)(this.hass,(function(t){n._subscribed&&(n._stateHistory=t)}),null!==(i=this._config.hours_to_show)&&void 0!==i?i:nt,(this._configEntities||[]).map((function(t){return t.entity})),!1,!1,!1).catch((function(t){n._subscribed=void 0,n._error=t})))}},{kind:"method",key:"_unsubscribeHistory",value:function(){this._subscribed&&(this._subscribed.then((function(t){return null==t?void 0:t()})),this._subscribed=void 0)}},{kind:"method",key:"updated",value:function(t){var e;null!==(e=this._configEntities)&&void 0!==e&&e.length?this._subscribed&&!t.has("_config")||(this._unsubscribeHistory(),this._subscribeHistory()):this._unsubscribeHistory(),t.has("_config")&&this._computePadding()}},{kind:"method",key:"_computePadding",value:function(){var t=this.shadowRoot.getElementById("root"),e="panel"===this.layout||"grid"===this.layout;if(this._config&&!e&&t)if(this._config.aspect_ratio){t.style.height="auto";var i=(0,q.A)(this._config.aspect_ratio);t.style.paddingBottom=i&&i.w>0&&i.h>0?"".concat((100*i.h/i.w).toFixed(2),"%"):t.style.paddingBottom="100%"}else t.style.paddingBottom="100%"}},{kind:"method",key:"_fitMap",value:function(){var t;null===(t=this._map)||void 0===t||t.fitMap()}},{kind:"method",key:"_getColor",value:function(t){var e=this._colorDict[t];return e||(e=(0,L.Vy)(this._colorIndex),this._colorIndex++,this._colorDict[t]=e,e)}},{kind:"method",key:"_getSourceEntities",value:function(t){var e;if(!t||null===(e=this._config)||void 0===e||!e.geo_location_sources)return[];for(var i=[],n=this._config.geo_location_sources.includes("all"),o=0,r=Object.values(t);o<r.length;o++){var s=r[o];"geo_location"===(0,T.m)(s.entity_id)&&(n||this._config.geo_location_sources.includes(s.attributes.source))&&i.push(s.entity_id)}return i}},{kind:"method",key:"_getMapEntities",value:function(){var t,e=this;return[].concat((0,a.A)((this._configEntities||[]).map((function(t){return{entity_id:t.entity,color:e._getColor(t.entity),label_mode:t.label_mode,focus:t.focus,name:t.name}}))),(0,a.A)(this._getSourceEntities(null===(t=this.hass)||void 0===t?void 0:t.states).map((function(t){return{entity_id:t,color:e._getColor(t)}}))))}},{kind:"field",key:"_getHistoryPaths",value:function(){var t=this;return(0,B.A)((function(e,i){var n;if(i&&(null!==(n=e.hours_to_show)&&void 0!==n?n:nt)){for(var o=[],r=function(){var n,r,c,h=u[a];if("zone"===(0,T.m)(h))return 0;var d=i[h];if(null==d||!d.length)return 0;var l,f=[],_=(0,s.A)(d);try{for(_.s();!(l=_.n()).done;){var v=l.value,g=v.a.latitude,k=v.a.longitude;if(g&&k){var m={};m.point=[g,k],m.timestamp=new Date(1e3*v.lu),f.push(m)}}}catch(b){_.e(b)}finally{_.f()}var p=null===(n=t._configEntities)||void 0===n?void 0:n.find((function(t){return t.entity===h})),y=null!==(r=null==p?void 0:p.name)&&void 0!==r?r:h in t.hass.states?(0,W.u)(t.hass.states[h]):h;o.push({points:f,name:y,fullDatetime:(null!==(c=e.hours_to_show)&&void 0!==c?c:nt)>144,color:t._getColor(h),gradualOpacity:.8})},a=0,u=Object.keys(i);a<u.length;a++)r();return o}}))}},{kind:"method",key:"getLayoutOptions",value:function(){return{grid_columns:4,grid_rows:4,grid_min_columns:2,grid_min_rows:2}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,N.AH)(it||(it=(0,u.A)(["ha-card{overflow:hidden;width:100%;height:100%;display:flex;flex-direction:column}ha-map{z-index:0;border:none;position:absolute;top:0;left:0;width:100%;height:100%;background:inherit}ha-icon-button{position:absolute;top:75px;left:3px;outline:0}#root{position:relative;height:100%}"])))}}]}}),N.WF),r(),t.next=94;break;case 91:t.prev=91,t.t2=t.catch(0),r(t.t2);case 94:case"end":return t.stop()}}),t,null,[[0,91]])})));return function(e,i){return t.apply(this,arguments)}}())},82115:function(t,e,i){var n=i(41765),o=i(13113),r=i(33616),s=i(64849),a=i(90924),u=i(26906),c=RangeError,h=String,d=Math.floor,l=o(a),f=o("".slice),_=o(1..toFixed),v=function(t,e,i){return 0===e?i:e%2==1?v(t,e-1,i*t):v(t*t,e/2,i)},g=function(t,e,i){for(var n=-1,o=i;++n<6;)o+=e*t[n],t[n]=o%1e7,o=d(o/1e7)},k=function(t,e){for(var i=6,n=0;--i>=0;)n+=t[i],t[i]=d(n/e),n=n%e*1e7},m=function(t){for(var e=6,i="";--e>=0;)if(""!==i||0===e||0!==t[e]){var n=h(t[e]);i=""===i?n:i+l("0",7-n.length)+n}return i};n({target:"Number",proto:!0,forced:u((function(){return"0.000"!==_(8e-5,3)||"1"!==_(.9,0)||"1.25"!==_(1.255,2)||"1000000000000000128"!==_(0xde0b6b3a7640080,0)}))||!u((function(){_({})}))},{toFixed:function(t){var e,i,n,o,a=s(this),u=r(t),d=[0,0,0,0,0,0],_="",p="0";if(u<0||u>20)throw new c("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return h(a);if(a<0&&(_="-",a=-a),a>1e-21)if(i=(e=function(t){for(var e=0,i=t;i>=4096;)e+=12,i/=4096;for(;i>=2;)e+=1,i/=2;return e}(a*v(2,69,1))-69)<0?a*v(2,-e,1):a/v(2,e,1),i*=4503599627370496,(e=52-e)>0){for(g(d,0,i),n=u;n>=7;)g(d,1e7,0),n-=7;for(g(d,v(10,n,1),0),n=e-1;n>=23;)k(d,1<<23),n-=23;k(d,1<<n),g(d,1,1),k(d,2),p=m(d)}else g(d,0,i),g(d,1<<-e,0),p=m(d)+l("0",u);return p=u>0?_+((o=p.length)<=u?"0."+l("0",u-o)+p:f(p,0,o-u)+"."+f(p,o-u)):_+p}})},59613:function(t,e,i){function n(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}i.d(e,{w:function(){return n}})},9854:function(t,e,i){i.d(e,{r:function(){return o}});var n=i(63165);function o(t,e){return+(0,n.o)(t)==+(0,n.o)(e)}},5343:function(t,e,i){i.d(e,{c:function(){return s}});var n=i(59613);function o(t){return(0,n.w)(t,Date.now())}var r=i(9854);function s(t){return(0,r.r)(t,o(t))}}}]);
//# sourceMappingURL=68285.HzUd0zt-kow.js.map