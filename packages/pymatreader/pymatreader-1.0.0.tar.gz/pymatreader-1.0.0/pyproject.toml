[project]
name = "pymatreader"
dynamic = ["version"]
description = "Convenient reader for Matlab mat files"
authors = [{name = "Thomas Hartmann", email = "thomas.hartmann@th-ht.de"},
           {name = "Dirk GÃ¼tlin", email = "dirk.guetlin@fu-berlin.de"}]
requires-python = ">= 3.9"
dependencies = ['h5py', 'scipy>=1.7.1', 'numpy', 'xmltodict']
readme = "README.md"
license = { text = "BSD-2-Clause" }
classifiers=[
        'Development Status :: 5 - Production/Stable',
        'Intended Audience :: Science/Research',
        'License :: OSI Approved :: BSD License',
        'Operating System :: OS Independent',
        'Programming Language :: Python',
        'Typing :: Typed',
        'Topic :: Scientific/Engineering',
        'Topic :: Software Development :: Libraries :: Python Modules'
    ]
keywords=['Matlab HDF5 import']

[build-system]
requires = ["hatchling", "hatch-regex-commit"]
build-backend = "hatchling.build"

[tool.pixi.project]
channels = ["conda-forge"]
platforms = ["linux-64", "osx-64", "win-64", "osx-arm64"]

[tool.pixi.pypi-dependencies]
pymatreader = { path = ".", editable = true }
id = "*"

[tool.pixi.feature]
py39 = {dependencies = {python="3.9.*"}}
py310 = {dependencies = {python="3.10.*"}}
py311 = {dependencies = {python="3.11.*"}}
py312 = {dependencies = {python="3.12.*"}}
numpy1 = {dependencies = {numpy="1.*"}}
numpy2 = {dependencies = {numpy="2.*"}}

[tool.pixi.environments]
testpy39np1 = ['py39', 'numpy1']
testpy310np1 = ['py310', 'numpy1']
testpy311np1 = ['py311', 'numpy1']
testpy312np1 = ['py312', 'numpy1']
testpy39np2 = ['py39', 'numpy2']
testpy310np2 = ['py310', 'numpy2']
testpy311np2 = ['py311', 'numpy2']
testpy312np2 = ['py312', 'numpy2']

[tool.pixi.dependencies]
hatch = ">=1.12.0,<2"
ruff = ">=0.5.5,<0.6"
pre-commit = ">=3.7.1,<4"
pytest = ">=8.3.2,<9"
pytest-cov = ">=5.0.0,<6"
mypy = ">=1.11.0,<2"
sphinx = ">=7.4.7,<8"
sphinx-autobuild = ">=2024.4.16,<2025"
sphinx_rtd_theme = ">=2.0.0,<3"

[tool.pixi.tasks]
test = "pytest --cov=pymatreader --cov-report=lcov"
lint = "ruff format && ruff check --fix"
lint_ci = "ruff check"
check_types = "mypy pymatreader tests"
doc_dev = "sphinx-autobuild doc/source doc/build"
build_docs = "cd doc; make clean; make html"

[tool.hatch.version]
source = "regex_commit"
path = "pymatreader/_version.py"
tag_sign = false

[tool.ruff]
line-length = 120
exclude = ['simulations', 'examples', 'paper']

[tool.ruff.lint]
extend-select = [
    'E',
    'W',
    'I',
    'UP',
    'C90',
    'N',
    'PTH',
    'SIM',
    'TCH',
    'PL',
    'D'
]
ignore = ['PLR0913']

[tool.ruff.format]
quote-style = 'single'

[tool.ruff.lint.pydocstyle]
convention = "numpy"

[tool.pytest.ini_options]
testpaths = ["tests"]

[tool.mypy]
disable_error_code = "import-untyped"
disallow_untyped_defs = false

[[tool.mypy.overrides]]
module = "pymatreader.*"
disallow_untyped_defs = true

