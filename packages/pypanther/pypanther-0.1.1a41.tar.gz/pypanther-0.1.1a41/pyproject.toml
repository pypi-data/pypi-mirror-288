[tool.poetry]
name = "pypanther"
version = "0.1.1a41"
description = ""
authors = ["Panther Labs Inc <pypi@runpanther.io>"]
readme = "README.md"
keywords = ["Security", "CLI"]
classifiers = ["Operating System :: OS Independent"]
license = "AGPL-3.0-only"
include = ["pypanther/py.typed"]

[tool.poetry.dependencies]
python = "3.11.*"
pydantic = "^2.7.1"
ruamel-yaml = "^0.18.6"
ast-comments = "^1.2.2"
panther-detection-helpers = "^0.4.0"
panther-core = ">= 0.10, < 1.0"
boto3 = "^1.34.99"
policyuniverse = "^1.5.1.20231109"
jsonpath-ng = "^1.6.1"
gql = "^3.5.0"
aiohttp = "^3.9.5"
dynaconf = "^3.2.5"
colorama = "^0.4.6"
prettytable = "^3.10.0"

[tool.poetry.scripts]
pypanther = 'pypanther.main:run'

[tool.poetry.group.dev.dependencies]
mypy = "^1.10.0"
pre-commit = "^3.7.0"
ruff = "^0.4.4"
types-python-dateutil = "^2.9.0.20240316"
types-pyyaml = "^6.0.12.20240311"

[tool.poetry.group.test.dependencies]
pytest = "^8.2.0"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"

[tool.mypy]
ignore_missing_imports = true
exclude = [
    '^pypanther/rules/',
    '^pypanther/helpers/',
    '^pypanther/data_models/',
]

[[tool.mypy.overrides]]
module = "panther_detection_helpers.*"
ignore_missing_imports = true

[[tool.mypy.overrides]]
module = "pypanther.data_models.*"
follow_imports = "skip"

[[tool.mypy.overrides]]
module = "pypanther.helpers.*"
follow_imports = "skip"

[[tool.mypy.overrides]]
module = "pypanther.rules.*"
follow_imports = "skip"

[tool.ruff]
# Exclude a variety of commonly ignored directories.
exclude = []
line-length = 120

[tool.ruff.lint.per-file-ignores]
"pypanther/helpers/*" = [
    # Helpers are converted automatically, so we don't want to fix this because it could be reverted
    # next time it is generated
    "E402", # Module level import not at top of file
]
