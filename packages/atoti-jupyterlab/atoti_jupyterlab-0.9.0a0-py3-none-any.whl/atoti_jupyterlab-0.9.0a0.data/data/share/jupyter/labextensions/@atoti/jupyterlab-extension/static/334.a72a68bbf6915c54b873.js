"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[334],{81412:(e,t,n)=>{n.d(t,{V:()=>w});var a=n(31529),i=n(93345),r=n(95889),o=n(46102),s=n(51462),d=n(38732),l=n(23107),u=n(10506),c=n(47355),g=n(89953),m=n(96135);const p=(e,t)=>{const n=(0,a.findKey)(e,(e=>"primaryOrdinal"===e.role)),i=n?t[n]:void 0;return i?i.at(-1):void 0};var h=n(90147),f=n(73939),x=n(99332);function w({cube:e,widgetState:t,onWidgetChange:n}){const w=function({cube:e,widgetState:t,onWidgetChange:n}){const{formatMessage:o}=(0,r.useIntl)(),d=(0,g.DP)(),[l]=(0,c.useWidgetPlugins)([t.widgetKey]),p=(0,i.useRef)(t),w=(0,i.useRef)(`expand-button-${(0,m.Y)()}`);(0,i.useEffect)((()=>{p.current=t}),[t]);const{attributes:y={}}=l,v=t.query.mdx,b=(0,i.useMemo)((()=>{if(!v)return;const e=(0,s.y)("primaryOrdinal",v);return v.axes.find((t=>t.name===e))}),[v]);if(!b)return;const C=(0,a.findKey)(y,(e=>"primaryOrdinal"===e.role)),I=C?t.mapping[C]:void 0;if(void 0===(I?I.at(-1):void 0))return;const M=(0,u.u)(b,{cube:e}).at(-1);if(!M)return;const{dimensionName:N,hierarchyName:S,levelName:k}=M,E=(0,f.Z)({cube:e,dimensionName:N,hierarchyName:S,levelName:k}),{isLevelExpandable:$}=(0,x.z)({hierarchyCoordinates:{dimensionName:N,hierarchyName:S},levelIndex:E,cube:e,mapping:t.mapping}),W=t.isInExpandMode&&$?d.textColor:d.disabledTextColor,L={width:500,height:600,svg:`\n      <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <style>\n            a[data-attr="${w.current}"] {\n              cursor: ${$?"pointer":"not-allowed"}!important;\n            }\n        </style>\n        <path d="M12.0007 6.52222H0.416495C0.0690387 6.52222 -0.124973 6.88907 0.0902035 7.13953L5.88233 13.8558C6.04812 14.0481 6.36735 14.0481 6.53491 13.8558L12.327 7.13953C12.5422 6.88907 12.3482 6.52222 12.0007 6.52222Z" fill="${W}"/>\n        <rect x="3.51196" width="5.51877" height="6.5256" rx="1" fill="${W}"/>\n      </svg>`};return{title:$?o({id:"aui.drillDown"}):o({id:"aui.cannotDrillDown"},{levelName:k}),name:"expandMode-"+($?t.isInExpandMode?"on":"off":"disabled"),icon:L,attr:w.current,click:$?()=>{const e=(0,h.produce)(p.current,(e=>{e.isInExpandMode=!e.isInExpandMode}));n?.(e)}:a.noop}}({cube:e,widgetState:t,onWidgetChange:n}),y=function({cube:e,onWidgetChange:t,widgetState:n}){const h=(0,g.DP)(),{formatMessage:f}=(0,r.useIntl)(),[x]=(0,c.useWidgetPlugins)([n.widgetKey]),w=(0,i.useRef)(`collapse-button-${(0,m.Y)()}`),y=(0,i.useRef)(n),v=(0,i.useRef)(void 0),b=(0,i.useMemo)((()=>p(x.attributes||{},n.mapping)),[x.attributes,n.mapping]),{mdx:C}=n.query,I=(0,i.useMemo)((()=>{if(!C)return;const e=(0,s.y)("primaryOrdinal",C);return e?C.axes.find((t=>t.name===e)):void 0}),[C]),M=(0,i.useMemo)((()=>{if(!C||!I)return;const t=(0,l.P)(I,e),n=t.reduce(((e,{tupleCoordinates:t})=>(t.length>e&&(e=t.length),e)),0);return t.filter((({tupleCoordinates:e})=>e.length===n)).map((e=>e.tupleCoordinates))}),[C,e,I]);if((0,i.useEffect)((()=>{y.current=n}),[n]),(0,i.useEffect)((()=>{v.current=M}),[M]),!b)return;const N=void 0!==M&&0!==M.length;if(!I)return;const S=(0,u.u)(I,{cube:e}).at(-1);if(!S)return;const{dimensionName:k,hierarchyName:E,levelName:$}=S,W=(0,o.q)({dimensionName:k,hierarchyName:E},e).levels,L=W[$].index,T=N?Object.keys(W).find((e=>W[e].index===L-1)):void 0,D=N?f({id:"aui.goUp"},{levelName:T}):f({id:"aui.cannotGoUp"},{hierarchyName:E,levelName:$});return{icon:{width:500,height:600,svg:`\n        <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" transform="matrix(1,0,0,-1,0,0)">\n            <style>\n                a[data-attr="${w.current}"] {\n                  cursor: ${N?"pointer":"not-allowed"}!important;\n                }\n            </style>\n            <path d="M12.0007 6.52222H0.416495C0.0690387 6.52222 -0.124973 6.88907 0.0902035 7.13953L5.88233 13.8558C6.04812 14.0481 6.36735 14.0481 6.53491 13.8558L12.327 7.13953C12.5422 6.88907 12.3482 6.52222 12.0007 6.52222Z" fill="${h.disabledTextColor}"></path>\n            <rect x="3.51196" width="5.51877" height="6.5256" rx="1" fill="${h.disabledTextColor}"></rect>\n        </svg>\n        `},title:D,name:"collapse"+(N?"":"-disabled"),click:N?()=>{const n=v.current,a=y.current;if(!n)return;const i=n.reduce(((t,n)=>(0,d.s)({cube:e,tupleCoordinates:n,widgetState:t})),a);t?.(i)}:a.noop,attr:w.current}}({cube:e,widgetState:t,onWidgetChange:n});return{modeBarButtonsToAdd:[y,w].filter((e=>void 0!==e))}}},94942:(e,t,n)=>{n.d(t,{_:()=>d});var a=n(93345),i=n(23446),r=n(51462),o=n(38875),s=n(79917);function d({cube:e,data:t,traces:n,widgetState:d,onWidgetChange:l}){const{mdx:u}=d.query,c=n[0].cellsIndices,g=(0,a.useMemo)((()=>u&&(0,r.y)("primaryOrdinal",u)),[u]);return(n,a)=>{const{pointIndex:r}=a,u=c[r]||[],{rowIndex:m,columnIndex:p}=u[0],h=g?(0,i.getHierarchyIndicesInCellSet)(t,{axisNames:[g]}):{},f=(0,i.getTuple)({columnIndex:p,data:t,hierarchyIndicesInCellSet:h,rowIndex:m});if(!f)throw new Error(`Could not find the corresponding tuple for the trace at index ${r}.`);const x=(0,i.trimTrailingTotals)(f,e);if(!x.at(-1))throw new Error("Cannot expand an empty tuple");const w=(0,o.J)({cube:e,mapping:d.mapping,tuple:f}),y=(0,s.N)({cube:e,toLevel:w,tupleCoordinates:x,widgetState:d});l?.(y)}}},10334:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var a=n(74389),i=n(49736),r=n.n(i),o=n(58814),s=n.n(o),d=n(93345),l=n(95889),u=n(99719),c=n(81412),g=n(94942),m=n(96126),p=n(79790),h=n(6934),f=n(98378),x=n(34924),w=n(50729),y=n(90442),v=n(22104),b=n(35420);const C={xaxis:"values",yaxis:"yAxis"};var I=n(6581);s().register(r());const M=(0,h.withLoadingOverlay)((0,h.withoutIrrelevantRenders)((0,u.c)((0,d.memo)((e=>{const{cube:t,data:n,metaData:i,widgetState:r}=e,{formatMessage:o}=(0,l.useIntl)(),[s]=(0,p.i)("style.members"),u=o({id:"aui.total"}),h=(0,d.useMemo)((()=>(0,I.y)({cube:t,data:n,metaData:i,widgetState:r,captionForTotals:u,userTupleStyles:s})),[t,n,i,r,u,s]),M=(0,d.useMemo)((()=>((e,t)=>{if(!e)return{};let n=(0,b.Z)({xaxis:{tickformat:"%"},yaxis:{gridcolor:"transparent"},barmode:"relative"},(0,f.w)(e.subplots),(0,x.M)(e.subplots,{x:{tickformat:"%"},y:{gridcolor:"transparent"},fontSize:t?.style?.axisLabelFontSize}),(0,w.n)(e,"yaxis"),(0,y.U)(t,C));return n=(0,v.C)(n,{axes:["xaxis","yaxis"],fontSize:t?.style?.axisLabelFontSize}),n})(i,r)),[i,r]),N=(0,c.V)({cube:t,widgetState:r,onWidgetChange:e.onChange}),S=(0,g._)({cube:t,data:n,traces:h,widgetState:r,onWidgetChange:e.onChange});return(0,a.Y)(m.Kl,{...e,config:N,onClick:r.isInExpandMode?S:void 0,traces:h,layout:M,cube:t,data:n,metaData:i})})))))}}]);