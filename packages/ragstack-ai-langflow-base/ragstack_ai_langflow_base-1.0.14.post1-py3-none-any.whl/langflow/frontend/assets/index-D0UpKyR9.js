import{bl as G,R as b,br as h,j as m,bi as O,r as c,bm as $,ci as J,bo as j,bp as T,bn as Q}from"./index-DYkSp9FA.js";function W(e){const t=e+"CollectionProvider",[i,n]=G(t),[w,v]=i(t,{collectionRef:{current:null},itemMap:new Map}),C=f=>{const{scope:o,children:u}=f,d=b.useRef(null),r=b.useRef(new Map).current;return m.jsx(w,{scope:o,itemMap:r,collectionRef:d,children:u})};C.displayName=t;const g=e+"CollectionSlot",p=b.forwardRef((f,o)=>{const{scope:u,children:d}=f,r=v(g,u),s=h(o,r.collectionRef);return m.jsx(O,{ref:s,children:d})});p.displayName=g;const a=e+"CollectionItemSlot",E="data-radix-collection-item",F=b.forwardRef((f,o)=>{const{scope:u,children:d,...r}=f,s=b.useRef(null),x=h(o,s),S=v(a,u);return b.useEffect(()=>(S.itemMap.set(s,{ref:s,...r}),()=>void S.itemMap.delete(s))),m.jsx(O,{[E]:"",ref:x,children:d})});F.displayName=a;function I(f){const o=v(e+"CollectionConsumer",f);return b.useCallback(()=>{const d=o.collectionRef.current;if(!d)return[];const r=Array.from(d.querySelectorAll(`[${E}]`));return Array.from(o.itemMap.values()).sort((S,A)=>r.indexOf(S.ref.current)-r.indexOf(A.ref.current))},[o.collectionRef,o.itemMap])}return[{Provider:C,Slot:p,ItemSlot:F},I,n]}var X=c.createContext(void 0);function Z(e){const t=c.useContext(X);return e||t||"ltr"}var M="rovingFocusGroup.onEntryFocus",ee={bubbles:!1,cancelable:!0},_="RovingFocusGroup",[N,L,te]=W(_),[oe,de]=G(_,[te]),[re,ne]=oe(_),K=c.forwardRef((e,t)=>m.jsx(N.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(N.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(se,{...e,ref:t})})}));K.displayName=_;var se=c.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:i,orientation:n,loop:w=!1,dir:v,currentTabStopId:C,defaultCurrentTabStopId:g,onCurrentTabStopIdChange:p,onEntryFocus:a,preventScrollOnEntryFocus:E=!1,...F}=e,I=c.useRef(null),f=h(t,I),o=Z(v),[u=null,d]=$({prop:C,defaultProp:g,onChange:p}),[r,s]=c.useState(!1),x=J(a),S=L(i),A=c.useRef(!1),[V,P]=c.useState(0);return c.useEffect(()=>{const l=I.current;if(l)return l.addEventListener(M,x),()=>l.removeEventListener(M,x)},[x]),m.jsx(re,{scope:i,orientation:n,dir:o,loop:w,currentTabStopId:u,onItemFocus:c.useCallback(l=>d(l),[d]),onItemShiftTab:c.useCallback(()=>s(!0),[]),onFocusableItemAdd:c.useCallback(()=>P(l=>l+1),[]),onFocusableItemRemove:c.useCallback(()=>P(l=>l-1),[]),children:m.jsx(j.div,{tabIndex:r||V===0?-1:0,"data-orientation":n,...F,ref:f,style:{outline:"none",...e.style},onMouseDown:T(e.onMouseDown,()=>{A.current=!0}),onFocus:T(e.onFocus,l=>{const Y=!A.current;if(l.target===l.currentTarget&&Y&&!r){const D=new CustomEvent(M,ee);if(l.currentTarget.dispatchEvent(D),!D.defaultPrevented){const y=S().filter(R=>R.focusable),H=y.find(R=>R.active),q=y.find(R=>R.id===u),z=[H,q,...y].filter(Boolean).map(R=>R.ref.current);B(z,E)}}A.current=!1}),onBlur:T(e.onBlur,()=>s(!1))})})}),k="RovingFocusGroupItem",U=c.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:i,focusable:n=!0,active:w=!1,tabStopId:v,...C}=e,g=Q(),p=v||g,a=ne(k,i),E=a.currentTabStopId===p,F=L(i),{onFocusableItemAdd:I,onFocusableItemRemove:f}=a;return c.useEffect(()=>{if(n)return I(),()=>f()},[n,I,f]),m.jsx(N.ItemSlot,{scope:i,id:p,focusable:n,active:w,children:m.jsx(j.span,{tabIndex:E?0:-1,"data-orientation":a.orientation,...C,ref:t,onMouseDown:T(e.onMouseDown,o=>{n?a.onItemFocus(p):o.preventDefault()}),onFocus:T(e.onFocus,()=>a.onItemFocus(p)),onKeyDown:T(e.onKeyDown,o=>{if(o.key==="Tab"&&o.shiftKey){a.onItemShiftTab();return}if(o.target!==o.currentTarget)return;const u=ie(o,a.orientation,a.dir);if(u!==void 0){if(o.metaKey||o.ctrlKey||o.altKey||o.shiftKey)return;o.preventDefault();let r=F().filter(s=>s.focusable).map(s=>s.ref.current);if(u==="last")r.reverse();else if(u==="prev"||u==="next"){u==="prev"&&r.reverse();const s=r.indexOf(o.currentTarget);r=a.loop?ae(r,s+1):r.slice(s+1)}setTimeout(()=>B(r))}})})})});U.displayName=k;var ce={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ue(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ie(e,t,i){const n=ue(e.key,i);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return ce[n]}function B(e,t=!1){const i=document.activeElement;for(const n of e)if(n===i||(n.focus({preventScroll:t}),document.activeElement!==i))return}function ae(e,t){return e.map((i,n)=>e[(t+n)%e.length])}var me=K,pe=U;function ve(e){const t=c.useRef({value:e,previous:e});return c.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}export{pe as I,me as R,de as a,ve as b,W as c,Z as u};
