import{U as I,a as y,g as P,r as c,j as e,i as F,I as m,c as R,u as f,av as B,l as j,at as L,au as u,z as b,ax as T,ay as _,az as $,aA as k}from"./index-DYkSp9FA.js";import{D as A,a as U,b as J,c as z}from"./index-BcZLMy_U.js";import{P as H}from"./index-BVjs444V.js";import{S as q}from"./index-BebcGXbf.js";import{D as G}from"./index-BpdXL-yr.js";import{N as Y}from"./index-Cnj-yD2z.js";import"./popover-DF2l564d.js";import"./index-D0UpKyR9.js";import"./separator-C8Y4kPf6.js";import"./index-BaEpDvL8.js";import"./input-B07-Z9fW.js";import"./label-aRG2Gi51.js";import"./checkbox-DNvnWRqS.js";import"./shortcuts-DpxtRUV4.js";import"./index-d46ICAZ1.js";const K=s=>{const{mutate:l}=I();return l(["useDeleteFolders"],async({folder_id:r})=>(await y.delete(`${P("FOLDERS")}/${r}`)).data,s)};function Q({firstButtonName:s,onFirstBtnClick:l,options:a,plusButton:n=!1,dropdownOptions:r=!0}){const[i,d]=c.useState(!1);return e.jsx("div",{children:e.jsxs(A,{open:i,children:[e.jsx(U,{asChild:!0,children:e.jsxs(F,{id:"new-project-btn",variant:"primary",className:"relative"+r?"pl-[12px]":"pl-[12px] pr-10",onClick:o=>{o.stopPropagation(),o.preventDefault(),l()},children:[n&&e.jsx(m,{name:"Plus",className:"main-page-nav-button"}),s,r&&e.jsx("div",{className:"absolute right-2 items-center text-muted-foreground",onClick:o=>{o.stopPropagation(),o.preventDefault(),d(!i)},children:i?e.jsx(m,{name:"ChevronUp"}):e.jsx(m,{name:"ChevronDown"})})]})}),e.jsx(J,{onPointerDownOutside:o=>{o.stopPropagation(),o.preventDefault(),d(!i)},children:a.map(({name:o,onBtnClick:h},p)=>e.jsx(z,{onClick:h,children:o},p))})]})})}const V=({openModal:s,setOpenModal:l,openDeleteFolderModal:a,setOpenDeleteFolderModal:n,handleDeleteFolder:r})=>e.jsxs(e.Fragment,{children:[s&&e.jsx(Y,{open:s,setOpen:l}),a&&e.jsx(G,{open:a,setOpen:n,onConfirm:()=>{r(),n(!1)},description:"folder",note:"Deleting the selected folder will remove all associated flows and components.",children:e.jsx(F,{variant:"ghost",size:"icon",className:"whitespace-nowrap",children:e.jsx(m,{"data-testid":"delete-folder",name:"Trash2",className:R("h-5 w-5")})})})]}),W=V,X=({uploadFlow:s,navigate:l,is_component:a})=>{const n=f(o=>o.setSuccessData),r=f(o=>o.setErrorData);return[...[{name:"Import from JSON",onBtnClick:()=>{s({newProject:!0,isComponent:a}).then(o=>{n({title:`${a?"Component":"Flow"} uploaded successfully`}),a||l("/flow/"+o)}).catch(o=>{r({title:B,list:[o]})})}}]]},Z=X;function he(){const s=j(t=>t.uploadFlow),l=j(t=>t.setCurrentFlowId),n=L().pathname,[r,i]=c.useState(!1),[d,o]=c.useState(!1),[h,p]=c.useState(!1),g=n==="/components",D=u(t=>t.setFolderToEdit),x=b(),C=f(t=>t.setSuccessData),S=f(t=>t.setErrorData),w=u(t=>t.folderToEdit),O=u(t=>t.myCollectionId),E=u(t=>t.getFoldersApi);c.useEffect(()=>{l("")},[n]);const N=Z({uploadFlow:s,navigate:x,is_component:g}),{mutate:v}=K(),M=()=>{v({folder_id:w==null?void 0:w.id},{onSuccess:()=>{C({title:"Folder deleted successfully."}),k(O),E(!0),x("/all")},onError:t=>{console.error(t),S({title:"Error deleting folder."})}})};return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:T,description:_,button:e.jsx("div",{className:"flex gap-2",children:e.jsx(Q,{firstButtonName:"New Project",onFirstBtnClick:()=>i(!0),options:N,plusButton:!0,dropdownOptions:!1})}),children:e.jsxs("div",{className:"flex h-full w-full space-y-8 md:flex-col lg:flex-row lg:space-x-8 lg:space-y-0",children:[e.jsx("aside",{className:"flex h-fit w-fit flex-col space-y-6",children:e.jsx(q,{items:[],handleChangeFolder:t=>{x(`all/folder/${t}`,{state:{folderId:t}})},handleEditFolder:t=>{D(t),o(!0)},handleDeleteFolder:t=>{D(t),p(!0)},className:"w-[20vw]"})}),e.jsx("div",{className:"relative h-full w-full flex-1",children:e.jsx($,{})})]})}),e.jsx(W,{openModal:r,setOpenModal:i,openDeleteFolderModal:h,setOpenDeleteFolderModal:p,handleDeleteFolder:M})]})}export{he as default};
